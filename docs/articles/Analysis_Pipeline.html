<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pipeline of the Paper â€¢ precision.seq</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pipeline of the Paper">
<meta property="og:description" content="precision.seq">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">precision.seq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Analysis_Pipeline.html">Pipeline of the Paper</a>
    </li>
    <li>
      <a href="../articles/Intro_Data.html">Introduction to DepthNorm Data</a>
    </li>
    <li>
      <a href="../articles/Intro_Functions.html">Introduction to DepthNorm Functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Analysis_Pipeline_files/header-attrs-2.3/header-attrs.js"></script><script src="Analysis_Pipeline_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pipeline of the Paper</h1>
            
      
      
      <div class="hidden name"><code>Analysis_Pipeline.Rmd</code></div>

    </div>

    
    
<div id="package-loading" class="section level1">
<h1 class="hasAnchor">
<a href="#package-loading" class="anchor"></a>Package Loading</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DescTools</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DESeq</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">edgeR</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">PoissonSeq</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">affy</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sva</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">RUVSeq</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">readr</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ape</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">EDASeq</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">limma</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">preprocessCore</span>); <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ffpe</span>)</pre></body></html></div>
</div>
<div id="data-loading" class="section level1">
<h1 class="hasAnchor">
<a href="#data-loading" class="anchor"></a>Data Loading</h1>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"../PaperData/Analysis_Pipeline.RData"</span>)
<span class="no">benchmark</span> <span class="kw">=</span> <span class="no">benchmark.RC</span>
<span class="no">test</span> <span class="kw">=</span> <span class="no">test.RC</span>
<span class="no">benchmark.cali</span> <span class="kw">=</span> <span class="no">benchmark.calibrator</span>
<span class="no">benchmark.pool</span> <span class="kw">=</span> <span class="no">benchmark.DECpool.RC</span></pre></body></html></div>
</div>
<div id="functions-for-depth-normalization" class="section level1">
<h1 class="hasAnchor">
<a href="#functions-for-depth-normalization" class="anchor"></a>Functions for Depth Normalization</h1>
<div id="trimmed-mean-of-m-values-tmm" class="section level2">
<h2 class="hasAnchor">
<a href="#trimmed-mean-of-m-values-tmm" class="anchor"></a>Trimmed Mean of M-values (TMM)</h2>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">## https://www.bioconductor.org/packages/devel/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.eps</span>
<span class="co">## page 14</span>
<span class="co">## cpm() could compute normalized count per million based on DGE result</span>
<span class="co">## We compute cor() between cpm() and our normalized benchmark data and find it to be 1</span>

<span class="no">norm.TMM</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>) {
  <span class="no">dat.DGE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">raw</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">groups</span>)),
                    <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>),
                    <span class="kw">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">raw</span>))
  <span class="no">d</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html">calcNormFactors</a></span>(<span class="no">dat.DGE</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"TMM"</span>)
  <span class="no">scaling.factor</span> <span class="kw">=</span> <span class="no">d</span>$<span class="no">samples</span>$<span class="no">norm.factors</span> * <span class="no">d</span>$<span class="no">samples</span>$<span class="no">lib.size</span> / <span class="fl">1e6</span>
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">raw</span>)/<span class="no">scaling.factor</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">scaling.factor</span> <span class="kw">=</span> <span class="no">scaling.factor</span>,
              <span class="kw">dge.normed</span> <span class="kw">=</span> <span class="no">d</span>))
}</pre></body></html></div>
</div>
<div id="total-count-tc" class="section level2">
<h2 class="hasAnchor">
<a href="#total-count-tc" class="anchor"></a>Total Count (TC)</h2>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## https://academic.oup.com/bib/article/14/6/671/189645</span>

<span class="no">norm.TC</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>) {
  <span class="no">dat.DGE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">raw</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">groups</span>)),
                    <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>),
                    <span class="kw">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">raw</span>))
  <span class="no">scaling.factor</span> <span class="kw">=</span> <span class="no">dat.DGE</span>$<span class="no">samples</span>$<span class="no">lib.size</span>/<span class="fl">1e6</span>
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">raw</span>)/<span class="no">scaling.factor</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">scaling.factor</span> <span class="kw">=</span> <span class="no">scaling.factor</span>))
}</pre></body></html></div>
</div>
<div id="upper-quartile-uq" class="section level2">
<h2 class="hasAnchor">
<a href="#upper-quartile-uq" class="anchor"></a>Upper Quartile (UQ)</h2>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">## calcNormFactors could also obtain the UQ normalization factor</span>
<span class="co">## We compute cor() between its UQ and our UQ normalized benchmark data and find it to be 1</span>

<span class="no">norm.UQ</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>) {
  <span class="no">dat.DGE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">raw</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">groups</span>)),
                    <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>),
                    <span class="kw">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">raw</span>))
  <span class="no">q.factor</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">dat.DGE</span>$<span class="no">counts</span>, <span class="fl">2</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="no">x</span>[<span class="no">x</span> <span class="kw">!=</span> <span class="fl">0</span>], <span class="kw">probs</span> <span class="kw">=</span> <span class="fl">0.75</span>))
  <span class="no">scaling.factor</span> <span class="kw">=</span> <span class="no">q.factor</span>/<span class="fl">1e6</span>
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">raw</span>)/<span class="no">scaling.factor</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">scaling.factor</span> <span class="kw">=</span> <span class="no">scaling.factor</span>))
}</pre></body></html></div>
</div>
<div id="median-med" class="section level2">
<h2 class="hasAnchor">
<a href="#median-med" class="anchor"></a>Median (Med)</h2>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co">## https://academic.oup.com/bib/article/14/6/671/189645</span>

<span class="no">norm.med</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>) {
  <span class="no">dat.DGE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">raw</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">groups</span>)),
                    <span class="kw">group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>),
                    <span class="kw">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">raw</span>))
  <span class="no">m.factor</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">dat.DGE</span>$<span class="no">counts</span>, <span class="fl">2</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">x</span>[<span class="no">x</span> <span class="kw">!=</span> <span class="fl">0</span>]))
  <span class="no">scaling.factor</span> <span class="kw">=</span> <span class="no">m.factor</span>/<span class="fl">1e6</span>
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">raw</span>)/<span class="no">scaling.factor</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">scaling.factor</span> <span class="kw">=</span> <span class="no">scaling.factor</span>))
}</pre></body></html></div>
</div>
<div id="deseq" class="section level2">
<h2 class="hasAnchor">
<a href="#deseq" class="anchor"></a>DESeq</h2>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co">## https://bioconductor.org/packages/release/bioc/vignettes/DESeq/inst/doc/DESeq.eps</span>
<span class="co">## page 4</span>

<span class="no">norm.DESeq</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>) {
  <span class="no">condition</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>)
  <span class="no">dat.DGE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq/man/estimateSizeFactors.html">estimateSizeFactors</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/DESeq/man/newCountDataSet.html">newCountDataSet</a></span>(<span class="no">raw</span>, <span class="no">condition</span>))
  <span class="no">scaling.factor</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq/man/sizeFactors.html">sizeFactors</a></span>(<span class="no">dat.DGE</span>)
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq/man/counts.html">counts</a></span>(<span class="no">dat.DGE</span>, <span class="kw">normalized</span> <span class="kw">=</span> <span class="no">T</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">scaling.factor</span> <span class="kw">=</span> <span class="no">scaling.factor</span>))
}</pre></body></html></div>
</div>
<div id="poissonseq" class="section level2">
<h2 class="hasAnchor">
<a href="#poissonseq" class="anchor"></a>PoissonSeq</h2>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co">## https://cran.r-project.org/web/packages/PoissonSeq/PoissonSeq.eps</span>

<span class="no">norm.PoissonSeq</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span> <span class="kw">=</span> <span class="kw">NULL</span>) {
  <span class="no">scaling.factor</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/PoissonSeq/man/PS.Est.Depth.html">PS.Est.Depth</a></span>(<span class="no">raw</span>)
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">raw</span>)/<span class="no">scaling.factor</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">scaling.factor</span> <span class="kw">=</span> <span class="no">scaling.factor</span>))
}</pre></body></html></div>
</div>
<div id="quantile-normalization-qn" class="section level2">
<h2 class="hasAnchor">
<a href="#quantile-normalization-qn" class="anchor"></a>Quantile Normalization (QN)</h2>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co">## http://jtleek.com/genstats/inst/doc/02_05_normalization.html</span>

<span class="no">norm.QN</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="kw">if</span> (<span class="no">filter</span> <span class="kw">==</span> <span class="fl">TRUE</span>) {
    <span class="no">raw</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">raw</span> + <span class="fl">1</span>)
    <span class="no">raw</span> <span class="kw">=</span> <span class="no">raw</span>[<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">raw</span>) <span class="kw">&gt;</span> <span class="fl">2</span>, ]
  } <span class="kw">else</span> {<span class="no">raw</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">raw</span> + <span class="fl">1</span>)}
  <span class="no">dat.log.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/normalizequantiles.html">normalizeQuantiles</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">raw</span>))
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fl">2</span>^<span class="no">dat.log.normed</span> - <span class="fl">1</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">dat.normed</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">raw</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">dat.normed</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">raw</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>))
}</pre></body></html></div>
</div>
<div id="sva-for-sequencing-svaseq" class="section level2">
<h2 class="hasAnchor">
<a href="#sva-for-sequencing-svaseq" class="anchor"></a>SVA for Sequencing (SVASeq)</h2>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co">## https://bioconductor.org/packages/release/bioc/vignettes/sva/inst/doc/sva.eps</span>
<span class="co">## page 13</span>
<span class="co">## calibrator genes include tag "cali"</span>
<span class="co">## Normalized data only used for exploration</span>
<span class="co">## https://www.biostars.org/p/121489/</span>

<span class="no">norm.SVA</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>) {
  <span class="no">filter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">raw</span>, <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>[<span class="no">x</span> <span class="kw">&gt;</span> <span class="fl">5</span>]) <span class="kw">&gt;=</span> <span class="fl">2</span>)
  <span class="no">dat.sva</span> <span class="kw">=</span> <span class="no">raw</span>[<span class="no">filter</span>, ]
  <span class="no">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">dat.sva</span>)
  <span class="no">mod1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="no">groups</span>)
  <span class="no">mod0</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">mod1</span>[,<span class="fl">1</span>])
  <span class="no">dat0</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">dat.sva</span>)
  <span class="no">svseq</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/sva/man/svaseq.html">svaseq</a></span>(<span class="no">dat0</span>, <span class="no">mod1</span>, <span class="no">mod0</span>, <span class="kw">n.sv</span> <span class="kw">=</span> <span class="fl">1</span>)$<span class="no">sv</span>
  <span class="no">adjust</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">mod1</span>, <span class="no">svseq</span>)
  <span class="no">hat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">adjust</span>) <span class="kw">%*%</span> <span class="no">adjust</span>) <span class="kw">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">adjust</span>)
  <span class="no">beta</span> <span class="kw">=</span> (<span class="no">hat</span> <span class="kw">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">raw</span>))
  <span class="no">P</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">mod1</span>)
  <span class="no">dat.normed</span> <span class="kw">=</span> <span class="no">raw</span> - <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">adjust</span>[,-<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="no">P</span>)]) <span class="kw">%*%</span> <span class="no">beta</span>[-<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="no">P</span>),])
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
              <span class="kw">adjust.factor</span> <span class="kw">=</span> <span class="no">svseq</span>))
}</pre></body></html></div>
</div>
<div id="remove-unwanted-variation-ruv" class="section level2">
<h2 class="hasAnchor">
<a href="#remove-unwanted-variation-ruv" class="anchor"></a>Remove Unwanted Variation (RUV)</h2>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co">## http://jtleek.com/svaseq/zebrafish.html</span>
<span class="co">## http://www.bioconductor.org/packages/devel/bioc/vignettes/RUVSeq/inst/doc/RUVSeq.eps</span>
<span class="co">## calibrator genes include tag "cali"</span>

<span class="no">norm.RUV</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>, <span class="no">method</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"RUVg"</span>, <span class="st">"RUVs"</span>, <span class="st">"RUVr"</span>)) {
  <span class="no">filter</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">raw</span>, <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>[<span class="no">x</span> <span class="kw">&gt;</span> <span class="fl">5</span>]) <span class="kw">&gt;=</span> <span class="fl">2</span>)
  <span class="no">dat.ruv</span> <span class="kw">=</span> <span class="no">raw</span>[<span class="no">filter</span>, ]
  <span class="no">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">dat.ruv</span>)
  <span class="no">condition</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>)
  <span class="no">set</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EDASeq/man/newSeqExpressionSet.html">newSeqExpressionSet</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">dat.ruv</span>),
                            <span class="kw">phenoData</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">condition</span>,
                                                   <span class="kw">row.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">dat.ruv</span>)))
  <span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="no">condition</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="fu">pData</span>(<span class="no">set</span>))
  <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq/man/counts.html">counts</a></span>(<span class="no">set</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="no">condition</span>)
  <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html">calcNormFactors</a></span>(<span class="no">y</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"upperquartile"</span>)
  <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/estimateGLMCommonDisp.html">estimateGLMCommonDisp</a></span>(<span class="no">y</span>, <span class="no">design</span>)
  <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/estimateGLMTagwiseDisp.html">estimateGLMTagwiseDisp</a></span>(<span class="no">y</span>, <span class="no">design</span>)
  <span class="no">fit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">glmFit</a></span>(<span class="no">y</span>, <span class="no">design</span>)
  <span class="no">lrt</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">glmLRT</a></span>(<span class="no">fit</span>, <span class="kw">coef</span> <span class="kw">=</span> <span class="fl">2</span>)
  <span class="no">top</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/topTags.html">topTags</a></span>(<span class="no">lrt</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">set</span>))$<span class="no">table</span>
  <span class="no">spikes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">set</span>)[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(!(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">set</span>) <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">top</span>)[<span class="fl">1</span>:<span class="fl">0.15</span>*<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">raw</span>)]))]

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"RUVg"</span>) {
    <span class="no">t</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RUVSeq/man/RUVg.html">RUVg</a></span>(<span class="no">set</span>, <span class="no">spikes</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">1</span>)
    <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EDASeq/man/SeqExpressionSet-class.html">normCounts</a></span>(<span class="no">t</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
                <span class="kw">adjust.factor</span> <span class="kw">=</span> <span class="no">t</span>$<span class="no">W</span>))
  }<span class="kw">else</span> <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"RUVs"</span>) {
    <span class="no">differences</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RUVSeq/man/makeGroups.html">makeGroups</a></span>(<span class="no">condition</span>)
    <span class="no">controls</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">dat.ruv</span>)
    <span class="no">t</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RUVSeq/man/RUVs.html">RUVs</a></span>(<span class="no">set</span>, <span class="no">controls</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="no">differences</span>)
    <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EDASeq/man/SeqExpressionSet-class.html">normCounts</a></span>(<span class="no">t</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
                <span class="kw">adjust.factor</span> <span class="kw">=</span> <span class="no">t</span>$<span class="no">W</span>))
  }<span class="kw">else</span> <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"RUVr"</span>) {
    <span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="no">condition</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="fu">pData</span>(<span class="no">set</span>))
    <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="kw">counts</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DESeq/man/counts.html">counts</a></span>(<span class="no">set</span>), <span class="kw">group</span> <span class="kw">=</span> <span class="no">condition</span>)
    <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/calcNormFactors.html">calcNormFactors</a></span>(<span class="no">y</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"upperquartile"</span>)
    <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/estimateGLMCommonDisp.html">estimateGLMCommonDisp</a></span>(<span class="no">y</span>, <span class="no">design</span>)
    <span class="no">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/estimateGLMTagwiseDisp.html">estimateGLMTagwiseDisp</a></span>(<span class="no">y</span>, <span class="no">design</span>)
    <span class="no">fit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/glmfit.html">glmFit</a></span>(<span class="no">y</span>, <span class="no">design</span>)
    <span class="no">res</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span>(<span class="no">fit</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"deviance"</span>)
    <span class="no">setUQ</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EDASeq/man/betweenLaneNormalization-methods.html">betweenLaneNormalization</a></span>(<span class="no">set</span>, <span class="kw">which</span> <span class="kw">=</span> <span class="st">"upper"</span>)
    <span class="no">controls</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">dat.ruv</span>)
    <span class="no">t</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RUVSeq/man/RUVr.html">RUVr</a></span>(<span class="no">setUQ</span>, <span class="no">controls</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="no">res</span>)
    <span class="no">dat.normed</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EDASeq/man/SeqExpressionSet-class.html">normCounts</a></span>(<span class="no">t</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dat.normed</span> <span class="kw">=</span> <span class="no">dat.normed</span>,
                <span class="kw">adjust.factor</span> <span class="kw">=</span> <span class="no">t</span>$<span class="no">W</span>))
  }
}</pre></body></html></div>
</div>
</div>
<div id="functions-for-differential-expression-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#functions-for-differential-expression-analysis" class="anchor"></a>Functions for Differential Expression Analysis</h1>
<div id="limma-voom-de" class="section level2">
<h2 class="hasAnchor">
<a href="#limma-voom-de" class="anchor"></a>limma-voom DE</h2>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co">## https://ucdavis-bioinformatics-training.github.io/2018-June-RNA-Seq-Workshop/thursday/DE.html</span>

<span class="no">DE.voom</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">RC</span>, <span class="no">groups</span>, <span class="no">P</span> <span class="kw">=</span> <span class="fl">0.01</span>, <span class="no">normalized</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="no">adjust</span> <span class="kw">=</span> <span class="kw">NULL</span>) {
  <span class="no">event</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>)
  <span class="kw">if</span> (<span class="no">normalized</span> <span class="kw">==</span> <span class="fl">TRUE</span>) {
    <span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="fl">0</span> + <span class="no">event</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">design</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">event</span>)
  } <span class="kw">else</span> {
    <span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="fl">0</span> + <span class="no">event</span> + <span class="no">adjust</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">design</span>)[<span class="fl">1</span>:<span class="fl">2</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">event</span>)
  }
  <span class="no">contrast.mx</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/makeContrasts.html">makeContrasts</a></span>(<span class="no">PMFH</span> - <span class="no">MXF</span>, <span class="kw">levels</span> <span class="kw">=</span> <span class="no">design</span>)
  <span class="no">d</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="no">RC</span>, <span class="kw">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">RC</span>))
  <span class="no">d.voom</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/voom.html">voom</a></span>(<span class="no">d</span>, <span class="no">design</span>)
  <span class="no">fit</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/lmFit.html">lmFit</a></span>(<span class="no">d.voom</span>, <span class="no">design</span>)
  <span class="no">fit.contr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/contrasts.fit.html">contrasts.fit</a></span>(<span class="no">fit</span>, <span class="no">contrast.mx</span>)
  <span class="no">fit.eb</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/limma/man/ebayes.html">eBayes</a></span>(<span class="no">fit.contr</span>)
  <span class="no">P.value</span> <span class="kw">=</span> <span class="no">fit.eb</span>$<span class="no">p.value</span>
  <span class="no">fc.log2</span> <span class="kw">=</span> <span class="no">fit.eb</span>$<span class="no">coef</span>

  <span class="no">out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">P.value</span>,<span class="no">fc.log2</span>)
  <span class="no">out</span> <span class="kw">=</span> <span class="no">out</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">out</span>[,<span class="fl">1</span>]),]
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">out</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Pvalue"</span>,<span class="st">"log2.FC(MXF/PMFH)"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">id.list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">out</span>[<span class="no">out</span>[,<span class="fl">1</span>] <span class="kw">&lt;</span> <span class="no">P</span>,]),
              <span class="kw">p.val</span> <span class="kw">=</span> <span class="no">out</span>))
}

<span class="no">norm.voom.pip</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>, <span class="no">method</span>,
                         <span class="no">RUV_method</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.none"</span>) {
      <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">raw</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)
  }

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"norm.TMM"</span>, <span class="st">"norm.TC"</span>, <span class="st">"norm.UQ"</span>, <span class="st">"norm.med"</span>,
                    <span class="st">"norm.DESeq"</span>, <span class="st">"norm.PoissonSeq"</span>)) {
      <span class="no">FUN</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.fun.html">match.fun</a></span>(<span class="no">method</span>)
      <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu">FUN</span>(<span class="no">raw</span>, <span class="no">groups</span>)$<span class="no">dat.normed</span>
      <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">test.norm</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)
  }

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.QN"</span>) {
    <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.QN.html">norm.QN</a></span>(<span class="no">raw</span>, <span class="no">groups</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="no">filter</span>)$<span class="no">dat.normed</span>
    <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">test.norm</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)
  }

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"norm.SVA"</span>, <span class="st">"norm.RUV"</span>)) {
      <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.SVA"</span>) {
        <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.SVA.html">norm.SVA</a></span>(<span class="no">raw</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">groups</span>)$<span class="no">adjust.factor</span>
        } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.RUV"</span>) {
          <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">raw</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">RUV_method</span>)$<span class="no">adjust.factor</span>
          }
    <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">raw</span>, <span class="no">groups</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>, <span class="kw">normalized</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">adjust</span> <span class="kw">=</span> <span class="no">test.norm</span>)
  }
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">test.DE</span> <span class="kw">=</span> <span class="no">test.DE</span>)
}</pre></body></html></div>
</div>
<div id="edger-de" class="section level2">
<h2 class="hasAnchor">
<a href="#edger-de" class="anchor"></a>edgeR DE</h2>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co">## https://web.stanford.edu/class/bios221/labs/rnaseq/lab_4_rnaseq.html </span>
<span class="co">## https://www.biostars.org/p/110861/</span>

<span class="no">DE.edgeR</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">RC</span>, <span class="no">groups</span>, <span class="no">P</span> <span class="kw">=</span> <span class="fl">0.01</span>, <span class="no">normalized</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="no">adjust</span> <span class="kw">=</span> <span class="kw">NULL</span>) {
  <span class="no">event</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">groups</span>);
  <span class="kw">if</span> (<span class="no">normalized</span> <span class="kw">==</span> <span class="fl">TRUE</span>) {
    <span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="fl">0</span> + <span class="no">event</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">design</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">event</span>)
  } <span class="kw">else</span> {
    <span class="no">design</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(~ <span class="fl">0</span> + <span class="no">event</span> + <span class="no">adjust</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">design</span>)[<span class="fl">1</span>:<span class="fl">2</span>] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">event</span>)
  }
  <span class="no">d</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html">DGEList</a></span>(<span class="no">RC</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">event</span>, <span class="kw">genes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">RC</span>))
  <span class="no">d</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/estimateDisp.html">estimateDisp</a></span>(<span class="no">d</span>, <span class="no">design</span>)
  <span class="no">DE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/exactTest.html">exactTest</a></span>(<span class="no">d</span>, <span class="kw">pair</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">d</span>$<span class="no">samples</span>$<span class="no">group</span>)[<span class="fl">1</span>:<span class="fl">2</span>])
  <span class="no">out</span> <span class="kw">=</span> <span class="no">DE</span>$<span class="no">table</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">1</span>)]
  <span class="no">out</span> <span class="kw">=</span> <span class="no">out</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">out</span>[,<span class="fl">1</span>]),]
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">out</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Pvalue"</span>,<span class="st">"log2.FC(MXF/PMFH)"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">id.list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">out</span>[<span class="no">out</span>[,<span class="fl">1</span>] <span class="kw">&lt;</span> <span class="no">P</span>,]),
              <span class="kw">p.val</span> <span class="kw">=</span> <span class="no">out</span>))
}

<span class="no">norm.edgeR.pip</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">groups</span>, <span class="no">method</span>,
                         <span class="no">RUV_method</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.none"</span>) {
      <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">raw</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>)
  }

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"norm.TMM"</span>, <span class="st">"norm.TC"</span>, <span class="st">"norm.UQ"</span>, <span class="st">"norm.med"</span>,
                    <span class="st">"norm.DESeq"</span>, <span class="st">"norm.PoissonSeq"</span>)) {
      <span class="no">FUN</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.fun.html">match.fun</a></span>(<span class="no">method</span>)
      <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu">FUN</span>(<span class="no">raw</span>, <span class="no">groups</span>)$<span class="no">dat.normed</span>
      <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">test.norm</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>)
  }

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.QN"</span>) {
    <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.QN.html">norm.QN</a></span>(<span class="no">raw</span>, <span class="no">groups</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="no">filter</span>)$<span class="no">dat.normed</span>
    <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">test.norm</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>)
  }

  <span class="kw">if</span> (<span class="no">method</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"norm.SVA"</span>, <span class="st">"norm.RUV"</span>)) {
      <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.SVA"</span>) {
        <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.SVA.html">norm.SVA</a></span>(<span class="no">raw</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">groups</span>)$<span class="no">adjust.factor</span>
        } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">method</span> <span class="kw">==</span> <span class="st">"norm.RUV"</span>) {
          <span class="no">test.norm</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">raw</span>, <span class="kw">group</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="no">RUV_method</span>)$<span class="no">adjust.factor</span>
          }
    <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">raw</span>, <span class="no">groups</span>, <span class="kw">normalized</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">adjust</span> <span class="kw">=</span> <span class="no">test.norm</span>)
  }
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw">test.DE</span> <span class="kw">=</span> <span class="no">test.DE</span>)
}</pre></body></html></div>
</div>
</div>
<div id="quality-check-for-benchmark-data" class="section level1">
<h1 class="hasAnchor">
<a href="#quality-check-for-benchmark-data" class="anchor"></a>Quality Check for Benchmark Data</h1>
<div id="correlation-among-pooled-benchmark-data" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-among-pooled-benchmark-data" class="anchor"></a>Correlation Among Pooled Benchmark Data</h2>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">benchmark.log</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">benchmark</span> + <span class="fl">1</span>)
<span class="no">benchmark.pool.log</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">benchmark.pool</span> + <span class="fl">1</span>)
<span class="no">benchmark.log.MXF.mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))])
<span class="no">benchmark.log.PMFH.mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))])
<span class="no">benchmark.pool.log.MXF.mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))])
<span class="no">benchmark.pool.log.PMFH.mean</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))])

<span class="no">CCC.pooled.benchmark.MXF</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">1</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">3</span>])$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>],
                             <span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">1</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">5</span>])$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>],
                             <span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">3</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">5</span>])$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>])
<span class="no">cor.pooled.benchmark.MXF</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">1</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">3</span>]),
                             <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">1</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">5</span>]),
                             <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">3</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">5</span>]))
<span class="no">CCC.pooled.benchmark.MXF</span>
<span class="co">#&gt; [1] 0.9683093 0.9839479 0.9720500</span>
<span class="no">cor.pooled.benchmark.MXF</span>
<span class="co">#&gt; [1] 0.9851294 0.9844770 0.9835578</span>


<span class="no">CCC.pooled.benchmark.PMFH</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">2</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">4</span>])$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>],
                              <span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">2</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">6</span>])$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>],
                              <span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">4</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">6</span>])$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>])
<span class="no">cor.pooled.benchmark.PMFH</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">2</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">4</span>]),
                              <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">2</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">6</span>]),
                              <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">benchmark.pool.log</span>[,<span class="fl">4</span>], <span class="no">benchmark.pool.log</span>[,<span class="fl">6</span>]))
<span class="no">CCC.pooled.benchmark.PMFH</span>
<span class="co">#&gt; [1] 0.9808560 0.9823032 0.9851071</span>
<span class="no">cor.pooled.benchmark.PMFH</span>
<span class="co">#&gt; [1] 0.9810193 0.9823441 0.9851556</span></pre></body></html></div>
</div>
<div id="relationship-between-pooled-and-individual-mxf-samples-figure-1a" class="section level2">
<h2 class="hasAnchor">
<a href="#relationship-between-pooled-and-individual-mxf-samples-figure-1a" class="anchor"></a>Relationship Between Pooled and Individual MXF Samples (Figure 1A)</h2>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/smoothScatter.html">smoothScatter</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.pool.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool.log</span>))]),
              <span class="no">benchmark.log.MXF.mean</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"log2(mean count across technical replicates for the pooled sample)"</span>,
              <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(mean count across individual tumor samples)"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"MXF"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
</div>
<div id="relationship-between-pooled-and-individual-pmfh-samples-figure-1b" class="section level2">
<h2 class="hasAnchor">
<a href="#relationship-between-pooled-and-individual-pmfh-samples-figure-1b" class="anchor"></a>Relationship Between Pooled and Individual PMFH Samples (Figure 1B)</h2>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/smoothScatter.html">smoothScatter</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.pool.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool.log</span>))]),
              <span class="no">benchmark.log.PMFH.mean</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"log2(mean count across technical replicates for the pooled sample)"</span>,
              <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(mean count across individual tumor samples)"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"PMFH"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
</div>
<div id="boxplot-for-calibrators-figure-1c" class="section level2">
<h2 class="hasAnchor">
<a href="#boxplot-for-calibrators-figure-1c" class="anchor"></a>Boxplot for Calibrators (Figure 1C)</h2>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">benchmark.cali.log</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">benchmark.cali</span> + <span class="fl">1</span>)
<span class="no">bench.cali.MXF</span> <span class="kw">=</span> <span class="no">benchmark.cali.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.cali</span>))]
<span class="no">bench.cali.PMFH</span> <span class="kw">=</span> <span class="no">benchmark.cali.log</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.cali</span>))]

<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">bench.cali.MXF</span>[<span class="fl">1</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">1</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">2</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">2</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">3</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">3</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">4</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">4</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">5</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">5</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">6</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">6</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">7</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">7</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">8</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">8</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">9</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">9</span>, ],
        <span class="no">bench.cali.MXF</span>[<span class="fl">10</span>, ], <span class="no">bench.cali.PMFH</span>[<span class="fl">10</span>, ],
        <span class="kw">at</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">22</span>,<span class="fl">23</span>,<span class="fl">25</span>,<span class="fl">26</span>,<span class="fl">28</span>,<span class="fl">29</span>),
        <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Calibrator Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>,
        <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>,
        <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"white"</span>, <span class="st">"grey"</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Calibrators"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">1</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.5</span>, <span class="fl">4.5</span>, <span class="fl">7.5</span>, <span class="fl">10.5</span>, <span class="fl">13.5</span>, <span class="fl">16.5</span>, <span class="fl">19.5</span>, <span class="fl">22.5</span>, <span class="fl">25.5</span>, <span class="fl">28.5</span>),
       <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cali_1"</span>, <span class="st">"cali_2"</span>, <span class="st">"cali_3"</span>, <span class="st">"cali_4"</span>, <span class="st">"cali_5"</span>, <span class="st">"cali_6"</span>,
                  <span class="st">"cali_7"</span>, <span class="st">"cali_8"</span>, <span class="st">"cali_9"</span>, <span class="st">"cali_10"</span>), <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">tck</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">15</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grey"</span>, <span class="st">"grey"</span>))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-18-1.png" width="864"></p>
</div>
<div id="scatter-plot-between-sextuplets-of-each-pooled-samples-figure-s1a" class="section level2">
<h2 class="hasAnchor">
<a href="#scatter-plot-between-sextuplets-of-each-pooled-samples-figure-s1a" class="anchor"></a>Scatter Plot Between Sextuplets of Each Pooled Samples (Figure S1A)</h2>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">benchmark.pool.MXF</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">benchmark.pool</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool</span>))] + <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool.MXF</span>) <span class="kw">=</span> <span class="fu">str_replace</span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool.MXF</span>), <span class="st">"MXF_"</span>, <span class="st">""</span>)

<span class="no">benchmark.pool.PMFH</span> <span class="kw">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">benchmark.pool</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool</span>))] + <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool.PMFH</span>) <span class="kw">=</span> <span class="fu">str_replace</span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.pool.PMFH</span>), <span class="st">"PMFH_"</span>, <span class="st">""</span>)

<span class="no">panel.cor</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>){
    <span class="no">usr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">"usr"</span>); <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="no">usr</span>))
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">usr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>))
    <span class="no">r</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="no">x</span>, <span class="no">y</span>), <span class="kw">digits</span> <span class="kw">=</span> <span class="fl">2</span>)
    <span class="no">txt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">""</span>, <span class="no">r</span>)
    <span class="no">cex.cor</span> <span class="kw">&lt;-</span> <span class="fl">0.8</span>/<span class="fu"><a href="https://rdrr.io/r/graphics/strwidth.html">strwidth</a></span>(<span class="no">txt</span>)
    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="no">txt</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="no">cex.cor</span> * <span class="no">r</span>)
}
<span class="no">panel_smooth</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">y</span>) {
  <span class="fu"><a href="https://rdrr.io/r/graphics/smoothScatter.html">smoothScatter</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">nrpoints</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)
}

<span class="co">## MXF</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(<span class="no">benchmark.pool.MXF</span>,
      <span class="kw">panel</span> <span class="kw">=</span> <span class="no">panel_smooth</span>,
      <span class="kw">upper.panel</span> <span class="kw">=</span> <span class="no">panel.cor</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"ScatterplotÂ for the Triplicate of the Pooled MXF"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-19-1.png" width="864"></p>
<div class="sourceCode" id="cb19"><html><body><pre class="r">
<span class="co">## PMFH</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(<span class="no">benchmark.pool.PMFH</span>,
      <span class="kw">panel</span> <span class="kw">=</span> <span class="no">panel_smooth</span>,
      <span class="kw">upper.panel</span> <span class="kw">=</span> <span class="no">panel.cor</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"ScatterplotÂ for the Triplicate of the Pooled PMFH"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-19-2.png" width="864"></p>
</div>
</div>
<div id="analysis-of-benchmark-data" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-benchmark-data" class="anchor"></a>Analysis of Benchmark Data</h1>
<div id="overall-data-distribution-figure-2a" class="section level2">
<h2 class="hasAnchor">
<a href="#overall-data-distribution-figure-2a" class="anchor"></a>Overall Data Distribution (Figure 2A)</h2>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">benchmark.log</span>,
        <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>)),
                     <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]),
        <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>),
        <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Benchmark Data"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-20-1.png" width="864"></p>
</div>
<div id="dea-figure-2b" class="section level2">
<h2 class="hasAnchor">
<a href="#dea-figure-2b" class="anchor"></a>DEA (Figure 2B)</h2>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">emp.group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'MXF'</span>,<span class="fl">9</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'PMFH'</span>,<span class="fl">9</span>)),<span class="fl">3</span>))
<span class="no">benchmark.voom</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">benchmark</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)
<span class="no">DE.bench</span> <span class="kw">=</span> <span class="no">benchmark.voom</span>$<span class="no">id.list</span>
<span class="no">benchmark.voom.dat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">dm</span> <span class="kw">=</span> <span class="no">benchmark.voom</span>$<span class="no">p.val</span>[,<span class="fl">2</span>],
                            <span class="kw">p.value</span> <span class="kw">=</span> <span class="no">benchmark.voom</span>$<span class="no">p.val</span>[,<span class="fl">1</span>])
<span class="no">mask</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">benchmark.voom.dat</span>, <span class="no">p.value</span> <span class="kw">&lt;</span> <span class="fl">.01</span>)
<span class="no">cols</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">mask</span>,<span class="st">"red"</span>, <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">benchmark.voom.dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">dm</span>, -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">p.value</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">.5</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>,
                          <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">3.6</span>, <span class="fl">3.6</span>),
                          <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">6</span>),
                          <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Difference: MXF - PMFH"</span>,
                          <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Volcano Plot"</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-21-1.png" width="864"></p>
</div>
<div id="scatterplot-of-group-mean-averages-v-s--group-mean-differences-for-significant-mirnas-figure-s2a" class="section level2">
<h2 class="hasAnchor">
<a href="#scatterplot-of-group-mean-averages-v-s--group-mean-differences-for-significant-mirnas-figure-s2a" class="anchor"></a>Scatterplot of Group Mean Averages V.S. Group Mean Differences for Significant MiRNAs (Figure S2A)</h2>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">benchmark.log</span>) <span class="kw">%in%</span> <span class="no">DE.bench</span>, <span class="st">"red"</span>, <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.log</span>),
     <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">benchmark.log</span>[,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))], <span class="fl">1</span>, <span class="no">mean</span>) -
       <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">benchmark.log</span>[,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))], <span class="fl">1</span>, <span class="no">mean</span>),
     <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Average"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Mean Difference: MXF - PMFH"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Benchmark Data"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-22-1.png" width="864"></p>
</div>
<div id="group-mean-averages-for-significant-mirnas-figure-s2b" class="section level2">
<h2 class="hasAnchor">
<a href="#group-mean-averages-for-significant-mirnas-figure-s2b" class="anchor"></a>Group Mean Averages for Significant MiRNAs (Figure S2B)</h2>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">DE.bench</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">benchmark</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)$<span class="no">id.list</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">benchmark.log</span>[<span class="no">DE.bench</span>,]), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Average"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Histogram of Mean Averages for Significant MiRNAs in Benchmark Data"</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">16</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-23-1.png" width="864"></p>
</div>
<div id="group-mean-differences-for-significant-mirnas-figure-s2c" class="section level2">
<h2 class="hasAnchor">
<a href="#group-mean-differences-for-significant-mirnas-figure-s2c" class="anchor"></a>Group Mean Differences for Significant MiRNAs (Figure S2C)</h2>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">M.mean.bench</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">benchmark.log</span>[<span class="no">DE.bench</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))], <span class="fl">1</span>, <span class="no">mean</span>)
<span class="no">P.mean.bench</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">benchmark.log</span>[<span class="no">DE.bench</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>))], <span class="fl">1</span>, <span class="no">mean</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">M.mean.bench</span> - <span class="no">P.mean.bench</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Differences"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Histogram of Mean Differences for Significant MiRNAs in Benchmark Data"</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-24-1.png" width="864"></p>
</div>
</div>
<div id="analysis-of-test-data" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-test-data" class="anchor"></a>Analysis of Test Data</h1>
<div id="overall-data-distribution-figure-3a" class="section level2">
<h2 class="hasAnchor">
<a href="#overall-data-distribution-figure-3a" class="anchor"></a>Overall Data Distribution (Figure 3A)</h2>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="no">test.log</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test</span> + <span class="fl">1</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">test.log</span>,
        <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark.log</span>)),
                     <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]),
        <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span><span class="st">"log2(count)"</span>,
        <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>),
        <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-25-1.png" width="864"></p>
</div>
<div id="dea-figure-3b" class="section level2">
<h2 class="hasAnchor">
<a href="#dea-figure-3b" class="anchor"></a>DEA (Figure 3B)</h2>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">test.voom</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">test</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)
<span class="no">test.voom.dat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">dm</span> <span class="kw">=</span> <span class="no">test.voom</span>$<span class="no">p.val</span>[,<span class="fl">2</span>],
                            <span class="kw">p.value</span> <span class="kw">=</span> <span class="no">test.voom</span>$<span class="no">p.val</span>[,<span class="fl">1</span>])
<span class="no">mask</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">test.voom.dat</span>, <span class="no">p.value</span> <span class="kw">&lt;</span> <span class="fl">.01</span>)
<span class="no">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">mask</span>,<span class="st">"red"</span>, <span class="st">"black"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">test.voom.dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">dm</span>, -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">p.value</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">.5</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>,
                         <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">6</span>), <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">3.6</span>, <span class="fl">3.6</span>),
                         <span class="kw">col</span> <span class="kw">=</span> <span class="no">cols</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Difference: MXF - PMFH"</span>,
                         <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Volcano Plot"</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-26-1.png" width="864"></p>
</div>
<div id="venn-diagram-between-benchmark-and-test-figure-3c" class="section level2">
<h2 class="hasAnchor">
<a href="#venn-diagram-between-benchmark-and-test-figure-3c" class="anchor"></a>Venn Diagram Between Benchmark and Test (Figure 3C)</h2>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">pval.bench.test</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="kw">bench.pval</span> <span class="kw">=</span> <span class="no">benchmark.voom</span>$<span class="no">p.val</span>[,<span class="fl">1</span>],
                        <span class="kw">test.pval</span> <span class="kw">=</span> <span class="no">test.voom</span>$<span class="no">p.val</span>[<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">benchmark.voom</span>$<span class="no">p.val</span>),<span class="fl">1</span>]))
<span class="fu"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(<span class="no">pval.bench.test</span>)
<span class="no">bench.sig</span> <span class="kw">&lt;-</span> (<span class="no">bench.pval</span> <span class="kw">&lt;</span> <span class="fl">0.01</span>)
<span class="no">test.sig</span> <span class="kw">&lt;-</span> (<span class="no">test.pval</span> <span class="kw">&lt;</span> <span class="fl">0.01</span>)
<span class="no">venn2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">bench.sig</span>, <span class="no">test.sig</span>)

<span class="fu"><a href="https://rdrr.io/pkg/limma/man/venn.html">vennDiagram</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/limma/man/venn.html">vennCounts</a></span>(<span class="no">venn2</span>),
            <span class="kw">names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Benchmark"</span>, <span class="st">"Test"</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Venn Diagram"</span>,
            <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.5</span>, <span class="kw">counts.col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">1</span>))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-27-1.png" width="864"></p>
</div>
<div id="group-means-of-mxf-figure-s3a" class="section level2">
<h2 class="hasAnchor">
<a href="#group-means-of-mxf-figure-s3a" class="anchor"></a>Group Means of MXF (Figure S3A)</h2>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">benchmark.log.MXF.mean</span>,
     <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">test.log</span>[,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">test.log</span>))]), <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Average in Benchmark Data"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Mean Average in Test Data"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"MXF"</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-28-1.png" width="864"></p>
</div>
<div id="group-means-of-pmfh-figure-s3b" class="section level2">
<h2 class="hasAnchor">
<a href="#group-means-of-pmfh-figure-s3b" class="anchor"></a>Group Means of PMFH (Figure S3B)</h2>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">benchmark.log.PMFH.mean</span>,
     <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(<span class="no">test.log</span>[,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">test.log</span>))]), <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Mean Average in Benchmark Data"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Mean Average in Test Data"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"PMFH"</span>, <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>,<span class="fl">1</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-29-1.png" width="864"></p>
</div>
</div>
<div id="depth-normalization-methods-evaluation-using-voom" class="section level1">
<h1 class="hasAnchor">
<a href="#depth-normalization-methods-evaluation-using-voom" class="anchor"></a>Depth Normalization Methods Evaluation Using Voom</h1>
<div id="evaluation-metrics" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluation-metrics" class="anchor"></a>Evaluation Metrics</h2>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">emp.group</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'MXF'</span>,<span class="fl">9</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'PMFH'</span>,<span class="fl">9</span>)),<span class="fl">3</span>))
<span class="no">test.TMM</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.TMM.html">norm.TMM</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>)$<span class="no">dat.normed</span>
<span class="no">test.TC</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.TC.html">norm.TC</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>)$<span class="no">dat.normed</span>
<span class="no">test.UQ</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.UQ.html">norm.UQ</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>)$<span class="no">dat.normed</span>
<span class="no">test.med</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.med.html">norm.med</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>)$<span class="no">dat.normed</span>
<span class="no">test.DESeq</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.DESeq.html">norm.DESeq</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>)$<span class="no">dat.normed</span>
<span class="no">test.PoissonSeq</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.PoissonSeq.html">norm.PoissonSeq</a></span>(<span class="no">test</span>)$<span class="no">dat.normed</span>
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span>
<span class="no">test.QN</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.QN.html">norm.QN</a></span>(<span class="no">test</span>)$<span class="no">dat.normed</span>
<span class="no">test.QN.filter</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.QN.html">norm.QN</a></span>(<span class="no">test</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">dat.normed</span>
<span class="no">test.SVA</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.SVA.html">norm.SVA</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>)$<span class="no">dat.normed</span>
<span class="co">#&gt; Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="no">test.RUVg</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)$<span class="no">dat.normed</span>
<span class="no">test.RUVs</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)$<span class="no">dat.normed</span>
<span class="no">test.RUVr</span> <span class="kw">=</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)$<span class="no">dat.normed</span>

<span class="no">statistics</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">method</span>, <span class="no">RUV_method</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                      <span class="no">marker_selection</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="no">selected_marker</span> <span class="kw">=</span> <span class="kw">NULL</span>) {
  <span class="no">voom.test</span> <span class="kw">=</span> <span class="fu">norm.voom.pip</span>(<span class="kw">raw</span> <span class="kw">=</span> <span class="no">test</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>,
                            <span class="kw">method</span> <span class="kw">=</span> <span class="no">method</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="no">RUV_method</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="no">filter</span>)
  <span class="no">voom.bench</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">benchmark</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)

  <span class="no">stat.DE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">1033</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">stat.DE</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">benchmark</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">stat.DE</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Benchmark"</span>, <span class="st">"NormTest"</span>)
  <span class="no">stat.DE</span>[<span class="no">voom.bench</span>$<span class="no">id.list</span>, <span class="fl">1</span>] <span class="kw">=</span> <span class="st">"DE"</span>
  <span class="no">stat.DE</span>[<span class="no">voom.test</span>$<span class="no">id.list</span>, <span class="fl">2</span>] <span class="kw">=</span> <span class="st">"DE"</span>
  <span class="no">stat.DE</span>[<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">stat.DE</span>)] <span class="kw">=</span> <span class="st">"non-DE"</span>
  <span class="kw">if</span> (<span class="no">marker_selection</span> <span class="kw">==</span> <span class="fl">TRUE</span>) {<span class="no">stat.DE</span> <span class="kw">=</span> <span class="no">stat.DE</span>[<span class="no">selected_marker</span>,]}
  <span class="no">t</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="kw">prediction</span> <span class="kw">=</span> <span class="no">stat.DE</span>[,<span class="fl">2</span>], <span class="kw">truth</span> <span class="kw">=</span> <span class="no">stat.DE</span>[,<span class="fl">1</span>])
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">table</span> <span class="kw">=</span> <span class="no">t</span>,
              <span class="kw">TPR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">1</span>,<span class="fl">1</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[,<span class="fl">1</span>]),
              <span class="kw">FPR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">1</span>,<span class="fl">2</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[,<span class="fl">2</span>]),
              <span class="kw">FDR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">1</span>,<span class="fl">2</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[<span class="fl">1</span>,]),
              <span class="kw">FNR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">2</span>,<span class="fl">1</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[,<span class="fl">1</span>])))
}

<span class="fu">statistics</span>(<span class="st">"norm.none"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      29     41</span>
<span class="co">#&gt;     non-DE  30    933</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.4915254</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.04209446</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.5857143</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.5084746</span>
<span class="fu">statistics</span>(<span class="st">"norm.TMM"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      20     19</span>
<span class="co">#&gt;     non-DE  39    955</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3389831</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.01950719</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.4871795</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6610169</span>
<span class="fu">statistics</span>(<span class="st">"norm.TC"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      24     25</span>
<span class="co">#&gt;     non-DE  35    949</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.4067797</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.02566735</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.5102041</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.5932203</span>
<span class="fu">statistics</span>(<span class="st">"norm.UQ"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      18     33</span>
<span class="co">#&gt;     non-DE  41    941</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3050847</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.0338809</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.6470588</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6949153</span>
<span class="fu">statistics</span>(<span class="st">"norm.med"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      16     38</span>
<span class="co">#&gt;     non-DE  43    936</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.2711864</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.03901437</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.7037037</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.7288136</span>
<span class="fu">statistics</span>(<span class="st">"norm.DESeq"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      22     30</span>
<span class="co">#&gt;     non-DE  37    944</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3728814</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.03080082</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.5769231</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6271186</span>
<span class="fu">statistics</span>(<span class="st">"norm.PoissonSeq"</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span>
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      22     17</span>
<span class="co">#&gt;     non-DE  37    957</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3728814</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.0174538</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.4358974</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6271186</span>
<span class="fu">statistics</span>(<span class="st">"norm.QN"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      20     31</span>
<span class="co">#&gt;     non-DE  39    943</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3389831</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.03182752</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.6078431</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6610169</span>
<span class="fu">statistics</span>(<span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      19     19</span>
<span class="co">#&gt;     non-DE  40    955</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3220339</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.01950719</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6779661</span>
<span class="fu">statistics</span>(<span class="st">"norm.SVA"</span>)
<span class="co">#&gt; Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      21     19</span>
<span class="co">#&gt;     non-DE  38    955</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.3559322</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.01950719</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.475</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.6440678</span>
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE       7      5</span>
<span class="co">#&gt;     non-DE  52    969</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.1186441</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.00513347</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.4166667</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.8813559</span>
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      36     93</span>
<span class="co">#&gt;     non-DE  23    881</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.6101695</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.09548255</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.7209302</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.3898305</span>
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)
<span class="co">#&gt; $table</span>
<span class="co">#&gt;           truth</span>
<span class="co">#&gt; prediction  DE non-DE</span>
<span class="co">#&gt;     DE      13      9</span>
<span class="co">#&gt;     non-DE  46    965</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $TPR</span>
<span class="co">#&gt; [1] 0.220339</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FPR</span>
<span class="co">#&gt; [1] 0.009240246</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FDR</span>
<span class="co">#&gt; [1] 0.4090909</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $FNR</span>
<span class="co">#&gt; [1] 0.779661</span></pre></body></html></div>
</div>
<div id="functions-for-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-plots" class="anchor"></a>Functions for Plots</h2>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="no">subsetp.concordance</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">groups</span>, <span class="no">method</span>,
                               <span class="no">RUV_method</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="no">test.DE</span> <span class="kw">=</span> <span class="fu">norm.voom.pip</span>(<span class="no">test</span>, <span class="no">groups</span>, <span class="no">method</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="no">RUV_method</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="no">filter</span>)
  <span class="no">benchmark.DE</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">benchmark</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)
  <span class="no">benchmark.DE.subset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(<span class="no">benchmark.DE</span>$<span class="no">p.val</span>[,<span class="fl">1</span>], <span class="no">benchmark.DE</span>$<span class="no">p.val</span>[,<span class="fl">1</span>] <span class="kw">&lt;</span> <span class="fl">0.01</span>)
  <span class="no">subset.gene</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">benchmark.DE.subset</span>), <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">test.DE</span>$<span class="no">p.val</span>[,<span class="fl">1</span>]))
  <span class="no">test.DE.subset</span> <span class="kw">=</span> <span class="no">test.DE</span>$<span class="no">p.val</span>[,<span class="fl">1</span>][<span class="no">subset.gene</span>]
  <span class="no">benchmark.DE.subset</span> <span class="kw">=</span> <span class="no">benchmark.DE.subset</span>[<span class="no">subset.gene</span>]
  <span class="no">benchmark.DE.log10</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">benchmark.DE.subset</span>)
  <span class="no">test.DE.log10</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">test.DE.subset</span>)
  <span class="no">conc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/DescTools/man/CCC.html">CCC</a></span>(<span class="no">benchmark.DE.log10</span>, <span class="no">test.DE.log10</span>)$<span class="no">rho.c</span>[<span class="fl">1</span>,<span class="fl">1</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">subp.benchmark</span> <span class="kw">=</span> <span class="no">benchmark.DE.log10</span>,
              <span class="kw">subp.test</span> <span class="kw">=</span> <span class="no">test.DE.log10</span>,
              <span class="kw">comp.test</span> <span class="kw">=</span> <span class="no">test.DE</span>$<span class="no">p.val</span>[,<span class="fl">1</span>],
              <span class="kw">conc</span> <span class="kw">=</span> <span class="no">conc</span>,
              <span class="kw">sig.test</span> <span class="kw">=</span> <span class="no">test.DE</span>$<span class="no">id.list</span>,
              <span class="kw">sig.benchmark</span> <span class="kw">=</span> <span class="no">benchmark.DE</span>$<span class="no">id.list</span>))
}

<span class="no">subp.test</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.none"</span>)
<span class="no">subp.TMM</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.TMM"</span>)
<span class="no">subp.TC</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.TC"</span>)
<span class="no">subp.UQ</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.UQ"</span>)
<span class="no">subp.med</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.med"</span>)
<span class="no">subp.DESeq</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.DESeq"</span>)
<span class="no">subp.PoissonSeq</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.PoissonSeq"</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span>
<span class="no">subp.QN</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.QN"</span>)
<span class="no">subp.QN.filter</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">subp.SVA</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.SVA"</span>)
<span class="co">#&gt; Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="no">subp.RUVg</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>,
                                <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)
<span class="no">subp.RUVr</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>,
                                <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)
<span class="no">subp.RUVs</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark</span>, <span class="no">test</span>, <span class="no">emp.group</span>,
                                <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)</pre></body></html></div>
</div>
<div id="rle-plots-figure-4" class="section level2">
<h2 class="hasAnchor">
<a href="#rle-plots-figure-4" class="anchor"></a>RLE Plots (Figure 4)</h2>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="co">### https://arxiv.org/postscript/1704.03590.eps</span>
<span class="no">rle.benchmark.raw</span> <span class="kw">=</span> <span class="no">benchmark</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark.raw</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">test</span>)
<span class="no">rle.benchmark</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">rle.benchmark.raw</span> + <span class="fl">1</span>)
<span class="no">rle.benchmark</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">rle.benchmark</span>, <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span> - <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">x</span>)))
<span class="no">MXF</span> <span class="kw">=</span> <span class="no">rle.benchmark</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>))]
<span class="no">MXF</span> <span class="kw">=</span> <span class="no">MXF</span>[, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">MXF</span>, <span class="fl">2</span>, <span class="no">quantile</span>)[<span class="fl">4</span>,], <span class="no">T</span>))]
<span class="no">PMFH</span> <span class="kw">=</span> <span class="no">rle.benchmark</span>[, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>))]
<span class="no">PMFH</span> <span class="kw">=</span> <span class="no">PMFH</span>[, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">PMFH</span>, <span class="fl">2</span>, <span class="no">quantile</span>)[<span class="fl">4</span>,], <span class="no">T</span>))]
<span class="no">rle.benchmark</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">MXF</span>, <span class="no">PMFH</span>)

<span class="no">RLE.plot</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">raw</span>, <span class="no">main</span>, <span class="no">bench</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="no">raw.log</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">raw</span> + <span class="fl">1</span>)
  <span class="no">rle</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">raw.log</span>, <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="no">x</span> - <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">x</span>)))
  <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">rle</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"RLE"</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">6</span>, <span class="fl">6</span>),
          <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="no">main</span>)
  <span class="kw">if</span> (<span class="no">bench</span> <span class="kw">==</span> <span class="fl">TRUE</span>) {
    <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))
  }
}

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">7</span>,<span class="fl">2</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu">RLE.plot</span>(<span class="no">rle.benchmark.raw</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Benchmark Data"</span>, <span class="kw">bench</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu">RLE.plot</span>(<span class="no">test</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data without Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.TMM</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with TMM Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.TC</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with Total Count Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.UQ</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with Upper Quantile Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.med</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with Median Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.DESeq</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with DESeq Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.PoissonSeq</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with PoissonSeq Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.QN</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with Quantile Normalization Normalization without Filtering"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.QN.filter</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with Quantile Normalization Normalization with Filtering"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.SVA</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with SVA Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.RUVg</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with RUVg Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.RUVr</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with RUVr Normalization"</span>)
<span class="fu">RLE.plot</span>(<span class="no">test.RUVs</span>[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">main</span> <span class="kw">=</span> <span class="st">"RLEplot for Test Data with RUVs Normalization"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-32-1.png" width="1920"></p>
</div>
<div id="overall-distribution-of-normalized-data-figure-s4" class="section level2">
<h2 class="hasAnchor">
<a href="#overall-distribution-of-normalized-data-figure-s4" class="anchor"></a>Overall Distribution of Normalized Data (Figure S4)</h2>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.TMM</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after TMM Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-1.png" width="864"></p>
<div class="sourceCode" id="cb34"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.TC</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after Total Count Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-2.png" width="864"></p>
<div class="sourceCode" id="cb35"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.UQ</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after Upper Quantile Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-3.png" width="864"></p>
<div class="sourceCode" id="cb36"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.med</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after Median Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-4.png" width="864"></p>
<div class="sourceCode" id="cb37"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.DESeq</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after DESeq Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-5.png" width="864"></p>
<div class="sourceCode" id="cb38"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.PoissonSeq</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after PoissonSeq Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-6.png" width="864"></p>
<div class="sourceCode" id="cb39"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.QN</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after Quantile Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-7.png" width="864"></p>
<div class="sourceCode" id="cb40"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.QN.filter</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after Quantile Normalization with Filtering"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-8.png" width="864"></p>
<div class="sourceCode" id="cb41"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.SVA</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after SVA Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-9.png" width="864"></p>
<div class="sourceCode" id="cb42"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.RUVg</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after RUVg Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-10.png" width="864"></p>
<div class="sourceCode" id="cb43"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.RUVr</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after RUVr Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-11.png" width="864"></p>
<div class="sourceCode" id="cb44"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="no">test.RUVs</span> + <span class="fl">1</span>)[,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">rle.benchmark</span>)], <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fl">27</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>], <span class="fl">27</span>)), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sample Index"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"log2(count)"</span>, <span class="kw">outline</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xaxt</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">staplewex</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Boxplot for Test Data after RUVs Normalization"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">2</span>)[<span class="fl">2</span>]))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-33-12.png" width="864"></p>
</div>
<div id="fnr-v-s--fdr-figure-5a" class="section level2">
<h2 class="hasAnchor">
<a href="#fnr-v-s--fdr-figure-5a" class="anchor"></a>FNR V.S. FDR (Figure 5A)</h2>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="no">emp.FNR</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
<span class="fu">statistics</span>(<span class="st">"norm.none"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.TMM"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.TC"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.UQ"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.med"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.DESeq"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.PoissonSeq"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.QN"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.SVA"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)$<span class="no">FNR</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="no">emp.FDR</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
<span class="fu">statistics</span>(<span class="st">"norm.none"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.TMM"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.TC"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.UQ"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.med"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.DESeq"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.PoissonSeq"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.QN"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.SVA"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)$<span class="no">FDR</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">emp.FNR</span>, <span class="no">emp.FDR</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">4</span>,<span class="fl">6</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">8</span>, <span class="fl">6</span>)), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>,
     <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.38</span>, <span class="fl">0.8</span>), <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.38</span>, <span class="fl">0.92</span>),
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"False Negative Rate"</span> , <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"False Discovery Rate"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Scatterplot for Depth Normalization Methods"</span>)
<span class="no">emp.FDR.loc</span> <span class="kw">=</span> <span class="no">emp.FDR</span> + <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.015</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.015</span>, <span class="fl">7</span>), <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.015</span>, <span class="fl">3</span>))
<span class="no">emp.FNR.loc</span> <span class="kw">=</span> <span class="no">emp.FNR</span> + <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.023</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">7</span>), -<span class="fl">0.02</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">3</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">emp.FDR.loc</span> ~ <span class="no">emp.FNR.loc</span>,
     <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No Norm"</span>, <span class="st">"TMM"</span>, <span class="st">"TC"</span>, <span class="st">"UQ"</span>, <span class="st">"Med"</span>, <span class="st">"DESeq"</span>,
                                   <span class="st">"PoissonSeq"</span>, <span class="st">"QN"</span>, <span class="st">"QN with Filtering"</span>,
                                   <span class="st">"SVA"</span>, <span class="st">"RUVg"</span>, <span class="st">"RUVr"</span>, <span class="st">"RUVs"</span>),
     <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">emp.FNR</span>, <span class="no">emp.FDR</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">font</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-34-1.png" width="960"></p>
</div>
<div id="catplot-figure-5b" class="section level2">
<h2 class="hasAnchor">
<a href="#catplot-figure-5b" class="anchor"></a>CATplot (Figure 5B)</h2>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="no">catplots</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="fl">7</span>)
<span class="no">benchmark.p</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="no">benchmark</span>, <span class="no">emp.group</span>)$<span class="no">p.val</span>[,<span class="fl">1</span>]
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.test</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.TMM</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.TC</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.UQ</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.med</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.DESeq</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.PoissonSeq</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)

<span class="no">color1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">7</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.7</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">1</span>],
     <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Rate of Agreement with Benchmark"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Significance Rank of MiRNAs"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"CATplot: Scaling-based Normalization Methods"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]], <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">2</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]], <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">3</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">4</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">5</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">6</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">7</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">75</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">xpd</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No Norm"</span>, <span class="st">"TMM"</span>, <span class="st">"TC"</span>, <span class="st">"UQ"</span>, <span class="st">"Med"</span>, <span class="st">"DESeq"</span>, <span class="st">"PoissonSeq"</span>),
       <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-35-1.png" width="960"></p>
</div>
<div id="catplot-figure-5c" class="section level2">
<h2 class="hasAnchor">
<a href="#catplot-figure-5c" class="anchor"></a>CATplot (Figure 5C)</h2>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="no">catplots</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="fl">7</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.test</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.QN</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.QN.filter</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.SVA</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.RUVg</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.RUVr</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">subp.RUVs</span>$<span class="no">comp.test</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)

<span class="no">color2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">7</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.7</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">1</span>],
     <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>,<span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Rate of Agreement with Benchmark"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Significance Rank of MiRNAs"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"CATplot: Regression-based Normalization Methods"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">2</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">3</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">4</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">5</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">6</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">7</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">70</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">xpd</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No Norm"</span>, <span class="st">"QN"</span>, <span class="st">"QN with Filtering"</span>, <span class="st">"SVA"</span>, <span class="st">"RUVg"</span>, <span class="st">"RUVr"</span>, <span class="st">"RUVs"</span>),
       <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">color1</span>[<span class="fl">1</span>], <span class="no">color2</span>[<span class="fl">2</span>:<span class="fl">7</span>]), <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">3</span>,<span class="fl">6</span>)))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-36-1.png" width="960"></p>
</div>
<div id="dendrograms-for-p-value-clustering-figure-5d" class="section level2">
<h2 class="hasAnchor">
<a href="#dendrograms-for-p-value-clustering-figure-5d" class="anchor"></a>Dendrograms for P-value Clustering (Figure 5D)</h2>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="no">pval.index</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">benchmark</span>)
<span class="no">pval.complete</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="kw">NoNorm</span> <span class="kw">=</span> <span class="no">subp.test</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">TMM</span> <span class="kw">=</span> <span class="no">subp.TMM</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">TC</span> <span class="kw">=</span> <span class="no">subp.TC</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">UQ</span> <span class="kw">=</span> <span class="no">subp.UQ</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">MED</span> <span class="kw">=</span> <span class="no">subp.med</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">DESeq</span> <span class="kw">=</span> <span class="no">subp.DESeq</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">PoissonSeq</span> <span class="kw">=</span> <span class="no">subp.PoissonSeq</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">QN</span> <span class="kw">=</span> <span class="no">subp.QN</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">QNwithFiltering</span> <span class="kw">=</span> <span class="no">subp.QN.filter</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">SVA</span> <span class="kw">=</span> <span class="no">subp.SVA</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">RUVg</span> <span class="kw">=</span> <span class="no">subp.RUVg</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">RUVr</span> <span class="kw">=</span> <span class="no">subp.RUVr</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>],
                      <span class="kw">RUVs</span> <span class="kw">=</span> <span class="no">subp.RUVs</span>$<span class="no">comp.test</span>[<span class="no">pval.index</span>])
<span class="no">dendrogram.p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(-<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">pval.complete</span>))
<span class="no">hc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">dendrogram.p</span>), <span class="kw">method</span> <span class="kw">=</span> <span class="st">"ward.D"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hc</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Dendrogram for Depth Normalization Methods"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-37-1.png" width="768"></p>
</div>
</div>
<div id="depth-normalization-methods-evaluation-using-edger" class="section level1">
<h1 class="hasAnchor">
<a href="#depth-normalization-methods-evaluation-using-edger" class="anchor"></a>Depth Normalization Methods Evaluation Using edgeR</h1>
<div id="fnr-v-s--fdr-figure-s5a" class="section level2">
<h2 class="hasAnchor">
<a href="#fnr-v-s--fdr-figure-s5a" class="anchor"></a>FNR V.S. FDR (Figure S5A)</h2>
<div class="sourceCode" id="cb49"><html><body><pre class="r"><span class="no">statistics.edgeR</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">method</span>, <span class="no">RUV_method</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="no">edgeR.test</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="kw">raw</span> <span class="kw">=</span> <span class="no">test</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>,
                            <span class="kw">method</span> <span class="kw">=</span> <span class="no">method</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="no">RUV_method</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="no">filter</span>)
  <span class="no">edgeR.bench</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="kw">RC</span> <span class="kw">=</span> <span class="no">benchmark</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">emp.group</span>, <span class="kw">P</span> <span class="kw">=</span> <span class="fl">0.01</span>)

  <span class="no">stat.DE</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">1033</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">stat.DE</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">benchmark</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">stat.DE</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Benchmark"</span>, <span class="st">"NormTest"</span>)
  <span class="no">stat.DE</span>[<span class="no">edgeR.bench</span>$<span class="no">id.list</span>, <span class="fl">1</span>] <span class="kw">=</span> <span class="st">"DE"</span>
  <span class="no">stat.DE</span>[<span class="no">edgeR.test</span>$<span class="no">id.list</span>, <span class="fl">2</span>] <span class="kw">=</span> <span class="st">"DE"</span>
  <span class="no">stat.DE</span>[<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">stat.DE</span>)] <span class="kw">=</span> <span class="st">"non-DE"</span>
  <span class="no">t</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="kw">prediction</span> <span class="kw">=</span> <span class="no">stat.DE</span>[,<span class="fl">2</span>], <span class="kw">truth</span> <span class="kw">=</span> <span class="no">stat.DE</span>[,<span class="fl">1</span>])
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">table</span> <span class="kw">=</span> <span class="no">t</span>,
              <span class="kw">TPR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">1</span>,<span class="fl">1</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[,<span class="fl">1</span>]),
              <span class="kw">FPR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">1</span>,<span class="fl">2</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[,<span class="fl">2</span>]),
              <span class="kw">FDR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">1</span>,<span class="fl">2</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[<span class="fl">1</span>,]),
              <span class="kw">FNR</span> <span class="kw">=</span> <span class="no">t</span>[<span class="fl">2</span>,<span class="fl">1</span>]/<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>[,<span class="fl">1</span>])))
}

<span class="no">emp.FNR</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.none"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.TMM"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.TC"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.UQ"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.med"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.DESeq"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.PoissonSeq"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.QN"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.SVA"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)$<span class="no">FNR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)$<span class="no">FNR</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="no">emp.FDR</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.none"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.TMM"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.TC"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.UQ"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.med"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.DESeq"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.PoissonSeq"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.QN"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.SVA"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)$<span class="no">FDR</span>,
<span class="fu">statistics.edgeR</span>(<span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)$<span class="no">FDR</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">emp.FNR</span>, <span class="no">emp.FDR</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">4</span>,<span class="fl">6</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">8</span>, <span class="fl">6</span>)), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>,
     <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.38</span>, <span class="fl">0.9</span>), <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.47</span>, <span class="fl">0.90</span>),
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"False Negative Rate"</span> , <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"False Discovery Rate"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Scatterplot of Depth Normalization Methods"</span>)
<span class="no">emp.FDR.loc</span> <span class="kw">=</span> <span class="no">emp.FDR</span> + <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.015</span>,    <span class="fl">0</span>, -<span class="fl">0.015</span>,-<span class="fl">0.02</span>,<span class="fl">0.02</span>,<span class="fl">0.015</span>,    <span class="fl">0</span>,<span class="fl">0.015</span>,<span class="fl">0.015</span>,<span class="fl">0.01</span>,    <span class="fl">0</span>,<span class="fl">0.02</span>,    <span class="fl">0</span>)
<span class="no">emp.FNR.loc</span> <span class="kw">=</span> <span class="no">emp.FNR</span> + <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>( <span class="fl">0.01</span>, <span class="fl">0.02</span>,      <span class="fl">0</span>,    <span class="fl">0</span>,   <span class="fl">0</span>, <span class="fl">0.03</span>,-<span class="fl">0.07</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,   <span class="fl">0</span>, <span class="fl">0.03</span>,   <span class="fl">0</span>,-<span class="fl">0.03</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">emp.FDR.loc</span> ~ <span class="no">emp.FNR.loc</span>,
     <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"NoNorm"</span>, <span class="st">"TMM"</span>, <span class="st">"TC"</span>, <span class="st">"UQ"</span>, <span class="st">"Med"</span>, <span class="st">"DESeq"</span>,
                                   <span class="st">"PoissonSeq"</span>, <span class="st">"QN"</span>, <span class="st">"QN with Filtering"</span>,
                                   <span class="st">"SVA"</span>, <span class="st">"RUVg"</span>, <span class="st">"RUVr"</span>, <span class="st">"RUVs"</span>),
     <span class="kw">data</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="no">emp.FNR</span>, <span class="no">emp.FDR</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.8</span>, <span class="kw">font</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-38-1.png" width="960"></p>
</div>
<div id="catplot-figure-s5bc" class="section level2">
<h2 class="hasAnchor">
<a href="#catplot-figure-s5bc" class="anchor"></a>CATplot (Figure S5BC)</h2>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="no">p.test</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.none"</span>)$<span class="no">p.val</span>
<span class="no">p.test.val</span> <span class="kw">=</span> <span class="no">p.test</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.test.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.test</span>)
<span class="no">p.TMM</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.TMM"</span>)$<span class="no">p.val</span>
<span class="no">p.TMM.val</span> <span class="kw">=</span> <span class="no">p.TMM</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.TMM.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.TMM</span>)
<span class="no">p.TC</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.TC"</span>)$<span class="no">p.val</span>
<span class="no">p.TC.val</span> <span class="kw">=</span> <span class="no">p.TC</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.TC.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.TC</span>)
<span class="no">p.UQ</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.UQ"</span>)$<span class="no">p.val</span>
<span class="no">p.UQ.val</span> <span class="kw">=</span> <span class="no">p.UQ</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.UQ.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.UQ</span>)
<span class="no">p.med</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.med"</span>)$<span class="no">p.val</span>
<span class="no">p.med.val</span> <span class="kw">=</span> <span class="no">p.med</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.med.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.med</span>)
<span class="no">p.DESeq</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.DESeq"</span>)$<span class="no">p.val</span>
<span class="no">p.DESeq.val</span> <span class="kw">=</span> <span class="no">p.DESeq</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.DESeq.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.DESeq</span>)
<span class="no">p.PoissonSeq</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.PoissonSeq"</span>)$<span class="no">p.val</span>
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span>
<span class="no">p.PoissonSeq.val</span> <span class="kw">=</span> <span class="no">p.PoissonSeq</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.PoissonSeq.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.PoissonSeq</span>)
<span class="no">p.QN</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.QN"</span>)$<span class="no">p.val</span>
<span class="no">p.QN.val</span> <span class="kw">=</span> <span class="no">p.QN</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.QN.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.QN</span>)
<span class="no">p.QN.filter</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.QN"</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)$<span class="no">p.val</span>
<span class="no">p.QN.filter.val</span> <span class="kw">=</span> <span class="no">p.QN.filter</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.QN.filter.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.QN.filter</span>)
<span class="no">p.SVA</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.SVA"</span>)$<span class="no">p.val</span>
<span class="co">#&gt; Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="no">p.SVA.val</span> <span class="kw">=</span> <span class="no">p.SVA</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.SVA.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.SVA</span>)
<span class="no">p.RUVg</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>,
                        <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)$<span class="no">p.val</span>
<span class="no">p.RUVg.val</span> <span class="kw">=</span> <span class="no">p.RUVg</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.RUVg.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.RUVg</span>)
<span class="no">p.RUVr</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>,
                        <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)$<span class="no">p.val</span>
<span class="no">p.RUVr.val</span> <span class="kw">=</span> <span class="no">p.RUVr</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.RUVr.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.RUVr</span>)
<span class="no">p.RUVs</span> <span class="kw">=</span> <span class="fu">norm.edgeR.pip</span>(<span class="no">test</span>, <span class="no">emp.group</span>,
                        <span class="kw">method</span> <span class="kw">=</span> <span class="st">"norm.RUV"</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)$<span class="no">p.val</span>
<span class="no">p.RUVs.val</span> <span class="kw">=</span> <span class="no">p.RUVs</span>[,<span class="fl">1</span>]; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">p.RUVs.val</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">p.RUVs</span>)


<span class="no">catplots</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="fl">7</span>)
<span class="no">benchmark.p</span> <span class="kw">=</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="no">benchmark</span>, <span class="no">emp.group</span>)$<span class="no">p.val</span>[,<span class="fl">1</span>]
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">benchmark.p</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="no">benchmark</span>, <span class="no">emp.group</span>)$<span class="no">p.val</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.test.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.TMM.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.TC.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.UQ.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.med.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.DESeq.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.PoissonSeq.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)

<span class="no">color1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">7</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.7</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">1</span>],
     <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Rate of Agreement with Benchmark"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Significance Rank of MiRNAs"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"CATplot: Scaling-based Normalization Methods"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]], <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">2</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]], <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">3</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">4</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">5</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">6</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">7</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">75</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">xpd</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No Norm"</span>, <span class="st">"TMM"</span>, <span class="st">"TC"</span>, <span class="st">"UQ"</span>, <span class="st">"Med"</span>, <span class="st">"DESeq"</span>, <span class="st">"PoissonSeq"</span>),
       <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-39-1.png" width="960"></p>
<div class="sourceCode" id="cb51"><html><body><pre class="r">
<span class="no">catplots</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(<span class="st">"list"</span>, <span class="fl">7</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.test.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.QN.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.QN.filter.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.SVA.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.RUVg.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.RUVr.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]] <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ffpe/man/CATplot.html">CATplot</a></span>(<span class="no">p.RUVs.val</span>, <span class="no">benchmark.p</span>, <span class="kw">maxrank</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">make.plot</span> <span class="kw">=</span> <span class="no">F</span>)

<span class="no">color2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">7</span>)

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1.2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">1</span>]], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.7</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="no">color1</span>[<span class="fl">1</span>],
     <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"l"</span>,<span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Rate of Agreement with Benchmark"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Significance Rank of MiRNAs"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"CATplot: Regression-based Normalization Methods"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">2</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">2</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">3</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">3</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">4</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">4</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">5</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">5</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">6</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">6</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="no">catplots</span><span class="kw">[[</span><span class="fl">7</span>]],<span class="kw">col</span> <span class="kw">=</span> <span class="no">color2</span>[<span class="fl">7</span>], <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">70</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">0.2</span>, <span class="kw">xpd</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No Norm"</span>, <span class="st">"QN"</span>, <span class="st">"QN with Filtering"</span>, <span class="st">"SVA"</span>, <span class="st">"RUVg"</span>, <span class="st">"RUVr"</span>, <span class="st">"RUVs"</span>),
       <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">color1</span>[<span class="fl">1</span>], <span class="no">color2</span>[<span class="fl">2</span>:<span class="fl">7</span>]), <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">3</span>,<span class="fl">6</span>)))</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-39-2.png" width="960"></p>
</div>
<div id="dendrogram-for-p-value-clustering-figure-s5d" class="section level2">
<h2 class="hasAnchor">
<a href="#dendrogram-for-p-value-clustering-figure-s5d" class="anchor"></a>Dendrogram for P-value Clustering (Figure S5D)</h2>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="no">pval.edgeR.complete</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/edgeR/man/cbind.html">cbind</a></span>(<span class="kw">NoNorm</span> <span class="kw">=</span> <span class="no">p.test.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">TMM</span> <span class="kw">=</span> <span class="no">p.TMM.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">TC</span> <span class="kw">=</span> <span class="no">p.TC.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">UQ</span> <span class="kw">=</span> <span class="no">p.UQ.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">MED</span> <span class="kw">=</span> <span class="no">p.med.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">DESeq</span> <span class="kw">=</span> <span class="no">p.DESeq.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">PoissonSeq</span> <span class="kw">=</span> <span class="no">p.PoissonSeq.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">QN</span> <span class="kw">=</span> <span class="no">p.QN.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">QNwithFiltering</span> <span class="kw">=</span> <span class="no">p.QN.filter.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">SVA</span> <span class="kw">=</span> <span class="no">p.SVA.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">RUVg</span> <span class="kw">=</span> <span class="no">p.RUVg.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">RUVr</span> <span class="kw">=</span> <span class="no">p.RUVr.val</span>[<span class="no">pval.index</span>],
                            <span class="kw">RUVs</span> <span class="kw">=</span> <span class="no">p.RUVs.val</span>[<span class="no">pval.index</span>])
<span class="no">dendrogram.p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(-<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(<span class="no">pval.edgeR.complete</span>))
<span class="no">hc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span>(<span class="no">dendrogram.p</span>), <span class="kw">method</span> <span class="kw">=</span> <span class="st">"ward.D"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span>(<span class="no">hc</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Dendrogram for Depth Normalization Methods"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-40-1.png" width="768"></p>
</div>
</div>
<div id="simulation-study" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-study" class="anchor"></a>Simulation Study</h1>
<div class="sourceCode" id="cb53"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">7</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">".*_"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">test</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">benchmark</span>)
<span class="no">simulation</span> <span class="kw">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="st">"../PaperData/simulation.csv"</span>)
<span class="no">sim.groups</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'MXF'</span>,<span class="fl">27</span>),<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'PMFH'</span>,<span class="fl">27</span>))

<span class="co">## Scenario 1: DE = 2% (1.75% - 2.25%), median mean-diff = (-0.5, 0.5) </span>
<span class="no">s1</span> <span class="kw">=</span>  <span class="no">simulation</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">proportion</span> <span class="kw">&gt;</span> <span class="fl">0.0175</span> <span class="kw">&amp;</span> <span class="no">proportion</span> <span class="kw">&lt;</span> <span class="fl">0.0225</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">median</span> <span class="kw">&gt;</span> -<span class="fl">0.5</span> <span class="kw">&amp;</span> <span class="no">median</span> <span class="kw">&lt;</span> <span class="fl">0.5</span>)
<span class="no">s1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">s1</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">701</span>, <span class="fl">100</span>), <span class="fl">1</span>:<span class="fl">54</span>])

<span class="co">## Scenario 2: DE = 2% (1% - 3%), median mean-diff = (2, 4) </span>
<span class="no">s2</span> <span class="kw">=</span>  <span class="no">simulation</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">proportion</span> <span class="kw">&gt;</span> <span class="fl">0.01</span> <span class="kw">&amp;</span> <span class="no">proportion</span> <span class="kw">&lt;</span> <span class="fl">0.03</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">median</span> <span class="kw">&gt;</span> <span class="fl">2</span> <span class="kw">&amp;</span> <span class="no">median</span> <span class="kw">&lt;</span> <span class="fl">4</span>)
<span class="no">s2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">s2</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">134</span>, <span class="fl">100</span>), <span class="fl">1</span>:<span class="fl">54</span>])

<span class="co">## Scenario 3: DE = 10% (7% - 13%), median mean-diff = (2, 4) </span>
<span class="no">s3</span> <span class="kw">=</span>  <span class="no">simulation</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">proportion</span> <span class="kw">&gt;</span> <span class="fl">0.07</span> <span class="kw">&amp;</span> <span class="no">proportion</span> <span class="kw">&lt;</span> <span class="fl">0.13</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">median</span> <span class="kw">&gt;</span> <span class="fl">2</span> <span class="kw">&amp;</span> <span class="no">median</span> <span class="kw">&lt;</span> <span class="fl">4</span>)
<span class="no">s3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">s3</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">102</span>, <span class="fl">100</span>), <span class="fl">1</span>:<span class="fl">54</span>])

<span class="co">## Scenario 4: DE = 20% (15% - 25%), median mean-diff = (2, 4) </span>
<span class="no">s4</span> <span class="kw">=</span>  <span class="no">simulation</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">proportion</span> <span class="kw">&gt;</span> <span class="fl">0.15</span> <span class="kw">&amp;</span> <span class="no">proportion</span> <span class="kw">&lt;</span> <span class="fl">0.25</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">median</span> <span class="kw">&gt;</span> <span class="fl">2</span> <span class="kw">&amp;</span> <span class="no">median</span> <span class="kw">&lt;</span> <span class="fl">4</span>)
<span class="no">s4</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">s4</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">119</span>, <span class="fl">100</span>), <span class="fl">1</span>:<span class="fl">54</span>])

<span class="no">summary.plot</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">simulation.plan</span>, <span class="no">method</span>, <span class="no">groups</span>, <span class="no">RUV_method</span> <span class="kw">=</span> <span class="kw">NULL</span>, <span class="no">filter</span> <span class="kw">=</span> <span class="fl">FALSE</span>) {
  <span class="no">FNR</span> <span class="kw">=</span> <span class="no">FDR</span> <span class="kw">=</span> <span class="no">conc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>()

  <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">simulation.plan</span>)) {
    <span class="no">benchmark.simu</span> <span class="kw">=</span> <span class="no">benchmark</span>[, <span class="no">simulation.plan</span>[<span class="no">i</span>, ]]
    <span class="no">test.simu</span> <span class="kw">=</span> <span class="no">test</span>[, <span class="no">simulation.plan</span>[<span class="no">i</span>, ]]
    <span class="no">t</span> <span class="kw">=</span> <span class="fu">subsetp.concordance</span>(<span class="no">benchmark.simu</span>, <span class="no">test.simu</span>, <span class="kw">groups</span> <span class="kw">=</span> <span class="no">groups</span>,
                            <span class="kw">method</span> <span class="kw">=</span> <span class="no">method</span>, <span class="kw">RUV_method</span> <span class="kw">=</span> <span class="no">RUV_method</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="no">filter</span>)

    <span class="no">TP</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">t</span>$<span class="no">sig.test</span> <span class="kw">%in%</span> <span class="no">t</span>$<span class="no">sig.benchmark</span>)
    <span class="no">FP</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">t</span>$<span class="no">sig.test</span>) - <span class="no">TP</span>
    <span class="no">FN</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">t</span>$<span class="no">sig.benchmark</span>) - <span class="no">TP</span>
    <span class="no">TN</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">benchmark.simu</span>) - <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">t</span>$<span class="no">sig.benchmark</span>) - <span class="no">FP</span>
    <span class="no">FNR</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">FNR</span>, <span class="no">FN</span>/(<span class="no">FN</span> + <span class="no">TP</span>))
    <span class="no">FDR</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">FDR</span>, <span class="no">FP</span>/(<span class="no">FP</span> + <span class="no">TP</span>))
    <span class="no">conc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">conc</span>, <span class="no">t</span>$<span class="no">conc</span>)
  }

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">FNR</span> <span class="kw">=</span> <span class="no">FNR</span>, <span class="kw">FDR</span> <span class="kw">=</span> <span class="no">FDR</span>, <span class="kw">conc</span> <span class="kw">=</span> <span class="no">conc</span>))
}</pre></body></html></div>
<div id="boxplot-fnr-and-fdr-figure-6" class="section level2">
<h2 class="hasAnchor">
<a href="#boxplot-fnr-and-fdr-figure-6" class="anchor"></a>Boxplot: FNR and FDR (Figure 6)</h2>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="no">summary.plot.scenario</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">s</span>){
  <span class="no">sum.none</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.none"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.TMM</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.TMM"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.TC</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.TC"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.UQ</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.UQ"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.med</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.med"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.DESeq</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.DESeq"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.PoissonSeq</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.PoissonSeq"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.QN</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.QN"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.QN.filter</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.QN"</span>, <span class="no">sim.groups</span>, <span class="kw">filter</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  <span class="no">sum.SVA</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.SVA"</span>, <span class="no">sim.groups</span>)
  <span class="no">sum.RUVg</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.RUV"</span>, <span class="no">sim.groups</span>, <span class="st">"RUVg"</span>)
  <span class="no">sum.RUVr</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.RUV"</span>, <span class="no">sim.groups</span>, <span class="st">"RUVr"</span>)
  <span class="no">sum.RUVs</span> <span class="kw">=</span> <span class="fu">summary.plot</span>(<span class="no">s</span>, <span class="st">"norm.RUV"</span>, <span class="no">sim.groups</span>, <span class="st">"RUVs"</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">none.FDR</span> <span class="kw">=</span> <span class="no">sum.none</span>$<span class="no">FDR</span>,
              <span class="kw">TMM.FDR</span> <span class="kw">=</span> <span class="no">sum.TMM</span>$<span class="no">FDR</span>,
              <span class="kw">TC.FDR</span> <span class="kw">=</span> <span class="no">sum.TC</span>$<span class="no">FDR</span>,
              <span class="kw">UQ.FDR</span> <span class="kw">=</span> <span class="no">sum.UQ</span>$<span class="no">FDR</span>,
              <span class="kw">med.FDR</span> <span class="kw">=</span> <span class="no">sum.med</span>$<span class="no">FDR</span>,
              <span class="kw">DESeq.FDR</span> <span class="kw">=</span> <span class="no">sum.DESeq</span>$<span class="no">FDR</span>,
              <span class="kw">PoissonSeq.FDR</span> <span class="kw">=</span> <span class="no">sum.PoissonSeq</span>$<span class="no">FDR</span>,
              <span class="kw">QN.FDR</span> <span class="kw">=</span> <span class="no">sum.QN</span>$<span class="no">FDR</span>,
              <span class="kw">QN.filter.FDR</span> <span class="kw">=</span> <span class="no">sum.QN.filter</span>$<span class="no">FDR</span>,
              <span class="kw">SVA.FDR</span> <span class="kw">=</span> <span class="no">sum.SVA</span>$<span class="no">FDR</span>,
              <span class="kw">RUVg.FDR</span> <span class="kw">=</span> <span class="no">sum.RUVg</span>$<span class="no">FDR</span>,
              <span class="kw">RUVr.FDR</span> <span class="kw">=</span> <span class="no">sum.RUVr</span>$<span class="no">FDR</span>,
              <span class="kw">RUVs.FDR</span> <span class="kw">=</span> <span class="no">sum.RUVs</span>$<span class="no">FDR</span>,
              <span class="kw">none.FNR</span> <span class="kw">=</span> <span class="no">sum.none</span>$<span class="no">FNR</span>,
              <span class="kw">TMM.FNR</span> <span class="kw">=</span> <span class="no">sum.TMM</span>$<span class="no">FNR</span>,
              <span class="kw">TC.FNR</span> <span class="kw">=</span> <span class="no">sum.TC</span>$<span class="no">FNR</span>,
              <span class="kw">UQ.FNR</span> <span class="kw">=</span> <span class="no">sum.UQ</span>$<span class="no">FNR</span>,
              <span class="kw">med.FNR</span> <span class="kw">=</span> <span class="no">sum.med</span>$<span class="no">FNR</span>,
              <span class="kw">DESeq.FNR</span> <span class="kw">=</span> <span class="no">sum.DESeq</span>$<span class="no">FNR</span>,
              <span class="kw">PoissonSeq.FNR</span> <span class="kw">=</span> <span class="no">sum.PoissonSeq</span>$<span class="no">FNR</span>,
              <span class="kw">QN.FNR</span> <span class="kw">=</span> <span class="no">sum.QN</span>$<span class="no">FNR</span>,
              <span class="kw">QN.filter.FNR</span> <span class="kw">=</span> <span class="no">sum.QN.filter</span>$<span class="no">FNR</span>,
              <span class="kw">SVA.FNR</span> <span class="kw">=</span> <span class="no">sum.SVA</span>$<span class="no">FNR</span>,
              <span class="kw">RUVg.FNR</span> <span class="kw">=</span> <span class="no">sum.RUVg</span>$<span class="no">FNR</span>,
              <span class="kw">RUVr.FNR</span> <span class="kw">=</span> <span class="no">sum.RUVr</span>$<span class="no">FNR</span>,
              <span class="kw">RUVs.FNR</span> <span class="kw">=</span> <span class="no">sum.RUVs</span>$<span class="no">FNR</span>))
}

<span class="no">boxplot.FDFN</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">s</span>, <span class="no">main</span>){
  <span class="no">s</span> <span class="kw">=</span> <span class="fu">summary.plot.scenario</span>(<span class="no">s</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.9</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">s</span>$<span class="no">none.FDR</span>, <span class="no">s</span>$<span class="no">none.FNR</span>,
          <span class="no">s</span>$<span class="no">TC.FDR</span>, <span class="no">s</span>$<span class="no">TC.FNR</span>,
          <span class="no">s</span>$<span class="no">UQ.FDR</span>, <span class="no">s</span>$<span class="no">UQ.FNR</span>,
          <span class="no">s</span>$<span class="no">med.FDR</span>, <span class="no">s</span>$<span class="no">med.FNR</span>,
          <span class="no">s</span>$<span class="no">DESeq.FDR</span>, <span class="no">s</span>$<span class="no">DESeq.FNR</span>,
          <span class="no">s</span>$<span class="no">PoissonSeq.FDR</span>, <span class="no">s</span>$<span class="no">PoissonSeq.FNR</span>,
          <span class="no">s</span>$<span class="no">TMM.FDR</span>, <span class="no">s</span>$<span class="no">TMM.FNR</span>,
          <span class="no">s</span>$<span class="no">QN.FDR</span>, <span class="no">s</span>$<span class="no">QN.FNR</span>,
          <span class="no">s</span>$<span class="no">QN.filter.FDR</span>, <span class="no">s</span>$<span class="no">QN.filter.FNR</span>,
          <span class="no">s</span>$<span class="no">SVA.FDR</span>, <span class="no">s</span>$<span class="no">SVA.FNR</span>,
          <span class="no">s</span>$<span class="no">RUVg.FDR</span>, <span class="no">s</span>$<span class="no">RUVg.FNR</span>,
          <span class="no">s</span>$<span class="no">RUVs.FDR</span>, <span class="no">s</span>$<span class="no">RUVs.FNR</span>,
          <span class="no">s</span>$<span class="no">RUVr.FDR</span>, <span class="no">s</span>$<span class="no">RUVr.FNR</span>,
          <span class="kw">at</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">22</span>,<span class="fl">23</span>,<span class="fl">25</span>,<span class="fl">26</span>,<span class="fl">28</span>,<span class="fl">29</span>,<span class="fl">31</span>,<span class="fl">32</span>,<span class="fl">34</span>,<span class="fl">35</span>,<span class="fl">37</span>,<span class="fl">38</span>),
          <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Log2 Count"</span>,
          <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">0.5</span>,
          <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"white"</span>, <span class="st">"grey"</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="no">main</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="fl">1</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.5</span>, <span class="fl">4.5</span>, <span class="fl">7.5</span>, <span class="fl">10.5</span>, <span class="fl">13.5</span>, <span class="fl">16.5</span>, <span class="fl">19.5</span>, <span class="fl">22.5</span>, <span class="fl">25.5</span>, <span class="fl">28.5</span>, <span class="fl">31.5</span>, <span class="fl">34.5</span>, <span class="fl">37.5</span>),
       <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No Norm"</span>, <span class="st">"TC"</span>, <span class="st">"UQ"</span>, <span class="st">"Med"</span>, <span class="st">"DESeq"</span>,
                  <span class="st">"PoissonSeq"</span>, <span class="st">"TMM"</span>, <span class="st">"QN"</span>, <span class="st">"QN with Filtering"</span>, <span class="st">"SVA"</span>,
                  <span class="st">"RUVg"</span>, <span class="st">"RUVs"</span>, <span class="st">"RUVr"</span>), <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">tck</span> <span class="kw">=</span> <span class="fl">0</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"bottomleft"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"False Discovery Rate"</span>, <span class="st">"False Negative Rate"</span>), <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>,
         <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">15</span>), <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grey"</span>, <span class="st">"grey"</span>))
}

<span class="fu">boxplot.FDFN</span>(<span class="no">s1</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Scenario 1: DE = 2%, median of group mean differences = 0"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-42-1.png" width="864"></p>
<div class="sourceCode" id="cb55"><html><body><pre class="r">
<span class="fu">boxplot.FDFN</span>(<span class="no">s2</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Scenario 2: DE = 2%, median of group mean differences = 3"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-42-2.png" width="864"></p>
<div class="sourceCode" id="cb56"><html><body><pre class="r">
<span class="fu">boxplot.FDFN</span>(<span class="no">s3</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Scenario 3: DE = 10%, median of group mean differences = 3"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-42-3.png" width="864"></p>
<div class="sourceCode" id="cb57"><html><body><pre class="r">
<span class="fu">boxplot.FDFN</span>(<span class="no">s4</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Scenario 4: DE = 20%, median of group mean differences = 3"</span>)</pre></body></html></div>
<p><img src="Analysis_Pipeline_files/figure-html/unnamed-chunk-42-4.png" width="864"></p>
</div>
</div>
<div id="package-information" class="section level1">
<h1 class="hasAnchor">
<a href="#package-information" class="anchor"></a>Package Information</h1>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 4.0.2 (2020-06-22)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt;  [1] stats4    splines   parallel  stats     graphics  grDevices utils    </span>
<span class="co">#&gt;  [8] datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] ffpe_1.32.0                 TTR_0.23-6                 </span>
<span class="co">#&gt;  [3] preprocessCore_1.50.0       ape_5.4                    </span>
<span class="co">#&gt;  [5] RUVSeq_1.22.0               EDASeq_2.22.0              </span>
<span class="co">#&gt;  [7] ShortRead_1.46.0            GenomicAlignments_1.24.0   </span>
<span class="co">#&gt;  [9] SummarizedExperiment_1.18.2 DelayedArray_0.14.0        </span>
<span class="co">#&gt; [11] matrixStats_0.56.0          Rsamtools_2.4.0            </span>
<span class="co">#&gt; [13] GenomicRanges_1.40.0        GenomeInfoDb_1.24.2        </span>
<span class="co">#&gt; [15] Biostrings_2.56.0           XVector_0.28.0             </span>
<span class="co">#&gt; [17] IRanges_2.22.2              S4Vectors_0.26.1           </span>
<span class="co">#&gt; [19] sva_3.36.0                  BiocParallel_1.22.0        </span>
<span class="co">#&gt; [21] genefilter_1.70.0           mgcv_1.8-31                </span>
<span class="co">#&gt; [23] nlme_3.1-148                affy_1.66.0                </span>
<span class="co">#&gt; [25] PoissonSeq_1.1.2            combinat_0.0-8             </span>
<span class="co">#&gt; [27] edgeR_3.30.3                limma_3.44.3               </span>
<span class="co">#&gt; [29] DESeq_1.39.0                lattice_0.20-41            </span>
<span class="co">#&gt; [31] locfit_1.5-9.4              Biobase_2.48.0             </span>
<span class="co">#&gt; [33] BiocGenerics_0.34.0         DescTools_0.99.36          </span>
<span class="co">#&gt; [35] forcats_0.5.0               stringr_1.4.0              </span>
<span class="co">#&gt; [37] dplyr_1.0.0                 purrr_0.3.4                </span>
<span class="co">#&gt; [39] readr_1.3.1                 tidyr_1.1.0                </span>
<span class="co">#&gt; [41] tibble_3.0.3                ggplot2_3.3.2              </span>
<span class="co">#&gt; [43] tidyverse_1.3.0            </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;   [1] readxl_1.3.1              backports_1.1.8          </span>
<span class="co">#&gt;   [3] aroma.light_3.18.0        BiocFileCache_1.12.0     </span>
<span class="co">#&gt;   [5] plyr_1.8.6                digest_0.6.25            </span>
<span class="co">#&gt;   [7] foreach_1.5.0             htmltools_0.5.0          </span>
<span class="co">#&gt;   [9] fansi_0.4.1               magrittr_1.5             </span>
<span class="co">#&gt;  [11] memoise_1.1.0             sfsmisc_1.1-7            </span>
<span class="co">#&gt;  [13] annotate_1.66.0           modelr_0.1.8             </span>
<span class="co">#&gt;  [15] R.utils_2.9.2             xts_0.12-0               </span>
<span class="co">#&gt;  [17] siggenes_1.62.0           askpass_1.1              </span>
<span class="co">#&gt;  [19] pkgdown_1.5.1             prettyunits_1.1.1        </span>
<span class="co">#&gt;  [21] jpeg_0.1-8.1              colorspace_1.4-1         </span>
<span class="co">#&gt;  [23] blob_1.2.1                rvest_0.3.5              </span>
<span class="co">#&gt;  [25] rappdirs_0.3.1            haven_2.3.1              </span>
<span class="co">#&gt;  [27] xfun_0.15                 crayon_1.3.4             </span>
<span class="co">#&gt;  [29] RCurl_1.98-1.2            jsonlite_1.7.0           </span>
<span class="co">#&gt;  [31] GEOquery_2.56.0           iterators_1.0.12         </span>
<span class="co">#&gt;  [33] survival_3.2-3            zoo_1.8-8                </span>
<span class="co">#&gt;  [35] glue_1.4.1                gtable_0.3.0             </span>
<span class="co">#&gt;  [37] lumi_2.40.0               zlibbioc_1.34.0          </span>
<span class="co">#&gt;  [39] Rhdf5lib_1.10.1           HDF5Array_1.16.1         </span>
<span class="co">#&gt;  [41] scales_1.1.1              mvtnorm_1.1-1            </span>
<span class="co">#&gt;  [43] rngtools_1.5              DBI_1.1.0                </span>
<span class="co">#&gt;  [45] Rcpp_1.0.5                xtable_1.8-4             </span>
<span class="co">#&gt;  [47] progress_1.2.2            bumphunter_1.30.0        </span>
<span class="co">#&gt;  [49] mclust_5.4.6              bit_1.1-15.2             </span>
<span class="co">#&gt;  [51] httr_1.4.1                RColorBrewer_1.1-2       </span>
<span class="co">#&gt;  [53] ellipsis_0.3.1            reshape_0.8.8            </span>
<span class="co">#&gt;  [55] pkgconfig_2.0.3           XML_3.99-0.4             </span>
<span class="co">#&gt;  [57] R.methodsS3_1.8.0         dbplyr_1.4.4             </span>
<span class="co">#&gt;  [59] tidyselect_1.1.0          rlang_0.4.7              </span>
<span class="co">#&gt;  [61] AnnotationDbi_1.50.1      munsell_0.5.0            </span>
<span class="co">#&gt;  [63] cellranger_1.1.0          tools_4.0.2              </span>
<span class="co">#&gt;  [65] cli_2.0.2                 generics_0.0.2           </span>
<span class="co">#&gt;  [67] RSQLite_2.2.0             broom_0.7.0              </span>
<span class="co">#&gt;  [69] evaluate_0.14             yaml_2.2.1               </span>
<span class="co">#&gt;  [71] knitr_1.29                bit64_0.9-7              </span>
<span class="co">#&gt;  [73] fs_1.4.2                  beanplot_1.2             </span>
<span class="co">#&gt;  [75] scrime_1.3.5              methylumi_2.34.0         </span>
<span class="co">#&gt;  [77] doRNG_1.8.2               nor1mix_1.3-0            </span>
<span class="co">#&gt;  [79] R.oo_1.23.0               xml2_1.3.2               </span>
<span class="co">#&gt;  [81] biomaRt_2.44.1            compiler_4.0.2           </span>
<span class="co">#&gt;  [83] rstudioapi_0.11           curl_4.3                 </span>
<span class="co">#&gt;  [85] png_0.1-7                 affyio_1.58.0            </span>
<span class="co">#&gt;  [87] reprex_0.3.0              geneplotter_1.66.0       </span>
<span class="co">#&gt;  [89] stringi_1.4.6             minfi_1.34.0             </span>
<span class="co">#&gt;  [91] GenomicFeatures_1.40.1    desc_1.2.0               </span>
<span class="co">#&gt;  [93] Matrix_1.2-18             multtest_2.44.0          </span>
<span class="co">#&gt;  [95] vctrs_0.3.1               pillar_1.4.6             </span>
<span class="co">#&gt;  [97] lifecycle_0.2.0           BiocManager_1.30.10      </span>
<span class="co">#&gt;  [99] data.table_1.12.8         bitops_1.0-6             </span>
<span class="co">#&gt; [101] rtracklayer_1.48.0        R6_2.4.1                 </span>
<span class="co">#&gt; [103] latticeExtra_0.6-29       hwriter_1.3.2            </span>
<span class="co">#&gt; [105] KernSmooth_2.23-17        nleqslv_3.3.2            </span>
<span class="co">#&gt; [107] codetools_0.2-16          boot_1.3-25              </span>
<span class="co">#&gt; [109] MASS_7.3-51.6             assertthat_0.2.1         </span>
<span class="co">#&gt; [111] rhdf5_2.32.2              openssl_1.4.2            </span>
<span class="co">#&gt; [113] rprojroot_1.3-2           withr_2.2.0              </span>
<span class="co">#&gt; [115] GenomeInfoDbData_1.2.3    expm_0.999-4             </span>
<span class="co">#&gt; [117] hms_0.5.3                 quadprog_1.5-8           </span>
<span class="co">#&gt; [119] grid_4.0.2                base64_2.0               </span>
<span class="co">#&gt; [121] DelayedMatrixStats_1.10.1 rmarkdown_2.3            </span>
<span class="co">#&gt; [123] illuminaio_0.30.0         lubridate_1.7.9</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Li-Xuan Qin, Jian Zou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
