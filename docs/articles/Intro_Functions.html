<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to DepthNorm Functions â€¢ DepthNorm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to DepthNorm Functions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DepthNorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro_Data.html">Introduction to DepthNorm Data</a>
    </li>
    <li>
      <a href="../articles/Intro_Functions.html">Introduction to DepthNorm Functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to DepthNorm Functions</h1>
            
      
      
      <div class="hidden name"><code>Intro_Functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DepthNorm)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DESeq)</span></code></pre></div>
<p>One critical aspect of RNA sequencing data normalization is the sequencing depth. We prepared nine commonly used depth normalization methods and a pair of well-designed datasets used for statistical evaluations in this package.</p>
<div id="functions-for-depth-normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-depth-normalization" class="anchor"></a>Functions for Depth Normalization</h2>
<p>In this section, we will present how to use the normalization functions in this package. The raw count data in the format of data frame or matrix (with columns for samples and rows for markers/genes) and the vector of characters indicating the group of each sample are needed as input. The output depends on the normalization methods. If the normalization methods are re-scalling based, normalized dataset and scalling factor will be provided as output; if the normalization methods are regression based, normalized dataset, which only used for exploration and the adjusting factor will be provided as output.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>emp.group =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'MXF'</span>,<span class="dv">9</span>),<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'PMFH'</span>,<span class="dv">9</span>)),<span class="dv">3</span>))</span>
<span id="cb2-2"><a href="#cb2-2"></a>test.TC =<span class="st"> </span><span class="kw"><a href="../reference/norm.TC.html">norm.TC</a></span>(test, emp.group)</span>
<span id="cb2-3"><a href="#cb2-3"></a>test.UQ =<span class="st"> </span><span class="kw"><a href="../reference/norm.UQ.html">norm.UQ</a></span>(test, emp.group)</span>
<span id="cb2-4"><a href="#cb2-4"></a>test.med =<span class="st"> </span><span class="kw"><a href="../reference/norm.med.html">norm.med</a></span>(test, emp.group)</span>
<span id="cb2-5"><a href="#cb2-5"></a>test.TMM =<span class="st"> </span><span class="kw"><a href="../reference/norm.TMM.html">norm.TMM</a></span>(test, emp.group)</span>
<span id="cb2-6"><a href="#cb2-6"></a>test.DESeq =<span class="st"> </span><span class="kw"><a href="../reference/norm.DESeq.html">norm.DESeq</a></span>(test, emp.group)</span>
<span id="cb2-7"><a href="#cb2-7"></a>test.PoissonSeq =<span class="st"> </span><span class="kw"><a href="../reference/norm.PoissonSeq.html">norm.PoissonSeq</a></span>(test)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>test.QN =<span class="st"> </span><span class="kw"><a href="../reference/norm.QN.html">norm.QN</a></span>(test)</span>
<span id="cb2-10"><a href="#cb2-10"></a>test.SVA =<span class="st"> </span><span class="kw"><a href="../reference/norm.SVA.html">norm.SVA</a></span>(test, emp.group)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; Number of significant surrogate variables is:  1 </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>test.RUVg =<span class="st">  </span><span class="kw"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(test, emp.group, <span class="dt">method =</span> <span class="st">"RUVg"</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>test.RUVs =<span class="st">  </span><span class="kw"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(test, emp.group, <span class="dt">method =</span> <span class="st">"RUVs"</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>test.RUVr =<span class="st">  </span><span class="kw"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(test, emp.group, <span class="dt">method =</span> <span class="st">"RUVr"</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(test.TMM<span class="op">$</span>scaling.factor)</span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; [1] 1.1988963 0.4295173 1.2377190 1.3487078 1.1959610 1.8503994</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(test.TMM<span class="op">$</span>dat.normed[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt;                    MXF2516      MXF742      MXF772       MXF832</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; hsa-let-7a-2*      0.00000     0.00000     0.00000     1.482901</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; hsa-let-7a(3)  70709.20148 14821.28856 48696.83516 53595.004767</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="co">#&gt; hsa-let-7a*(2)  2829.26889    34.92292   126.84623   269.146516</span></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co">#&gt; hsa-let-7b      7376.78480 10437.29762 20702.59825 20564.869850</span></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">#&gt; hsa-let-7b*       24.18891    32.59473    58.97946    83.042451</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="co">#&gt; hsa-let-7c     23107.92019  1008.10838 13457.01204  5153.822120</span></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co">#&gt;                      MXF836</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co">#&gt; hsa-let-7a-2*      1.672295</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">#&gt; hsa-let-7a(3)  39640.925166</span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">#&gt; hsa-let-7a*(2)   102.846164</span></span>
<span id="cb2-31"><a href="#cb2-31"></a><span class="co">#&gt; hsa-let-7b     14440.270362</span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co">#&gt; hsa-let-7b*       71.072552</span></span>
<span id="cb2-33"><a href="#cb2-33"></a><span class="co">#&gt; hsa-let-7c     11593.187526</span></span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(test.SVA<span class="op">$</span>adjust.factor)</span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="co">#&gt;             [,1]</span></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="co">#&gt; [1,]  0.28535304</span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="co">#&gt; [2,]  0.03121055</span></span>
<span id="cb2-39"><a href="#cb2-39"></a><span class="co">#&gt; [3,] -0.07462108</span></span>
<span id="cb2-40"><a href="#cb2-40"></a><span class="co">#&gt; [4,] -0.06139403</span></span>
<span id="cb2-41"><a href="#cb2-41"></a><span class="co">#&gt; [5,] -0.07546172</span></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co">#&gt; [6,] -0.12748833</span></span>
<span id="cb2-43"><a href="#cb2-43"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(test.SVA<span class="op">$</span>dat.normed[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="co">#&gt;                     MXF2516       MXF742        MXF772       MXF832</span></span>
<span id="cb2-45"><a href="#cb2-45"></a><span class="co">#&gt; hsa-let-7a-2*  3.126439e+00    0.3419549    -0.8175775     1.327343</span></span>
<span id="cb2-46"><a href="#cb2-46"></a><span class="co">#&gt; hsa-let-7a(3)  1.143937e+05 9605.7728904 52527.0508087 65911.068255</span></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="co">#&gt; hsa-let-7a*(2) 3.041342e+03  -23.3533362   248.6987096   438.444546</span></span>
<span id="cb2-48"><a href="#cb2-48"></a><span class="co">#&gt; hsa-let-7b     2.310206e+04 6042.4781503 21895.4551525 24668.362809</span></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="co">#&gt; hsa-let-7b*    6.650161e+01   18.1017473    63.1931625   103.931485</span></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="co">#&gt; hsa-let-7c     3.792122e+04 1550.5108226 13984.1515878  4752.753259</span></span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="co">#&gt;                      MXF836</span></span>
<span id="cb2-52"><a href="#cb2-52"></a><span class="co">#&gt; hsa-let-7a-2*      1.173212</span></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="co">#&gt; hsa-let-7a(3)  39575.789137</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="co">#&gt; hsa-let-7a*(2)   215.731738</span></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="co">#&gt; hsa-let-7b     13499.451384</span></span>
<span id="cb2-56"><a href="#cb2-56"></a><span class="co">#&gt; hsa-let-7b*       75.082684</span></span>
<span id="cb2-57"><a href="#cb2-57"></a><span class="co">#&gt; hsa-let-7c     11163.051990</span></span></code></pre></div>
</div>
<div id="functions-for-differential-expression-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-differential-expression-analysis" class="anchor"></a>Functions for Differential Expression Analysis</h2>
<p>We pack two DEA functions, edgeR and voom-limma, in this package. The input could be either the normalized dataset (always from re-scalling methods) or the non-normalized dataset with adjusting factor (always from regression-based methods). Names of DE markers/genes (p = 0.01 as cut-off point by default), p-values for each marker/gene, and log2 fold change are provided in output.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>edgeR.benchmark =<span class="st"> </span><span class="kw"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(benchmark, emp.group)</span>
<span id="cb3-2"><a href="#cb3-2"></a>voom.benchmark =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(benchmark, emp.group)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>edgeR.test.TMM =<span class="st"> </span><span class="kw"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(test.TMM<span class="op">$</span>dat.normed, emp.group)</span>
<span id="cb3-5"><a href="#cb3-5"></a>voom.test.TMM =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(test.TMM<span class="op">$</span>dat.normed, emp.group)</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>edgeR.test.RUVr =<span class="st"> </span><span class="kw"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(test, emp.group, </span>
<span id="cb3-8"><a href="#cb3-8"></a>                           <span class="dt">normalized =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>                           <span class="dt">adjust =</span> test.RUVr<span class="op">$</span>adjust.factor)</span>
<span id="cb3-10"><a href="#cb3-10"></a>voom.test.RUVr =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(test, emp.group, </span>
<span id="cb3-11"><a href="#cb3-11"></a>                         <span class="dt">normalized =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-12"><a href="#cb3-12"></a>                         <span class="dt">adjust =</span> test.RUVr<span class="op">$</span>adjust.factor)</span>
<span id="cb3-13"><a href="#cb3-13"></a></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(voom.benchmark<span class="op">$</span>id.list)</span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; [1] "hsa-miR-99a*"   "hsa-miR-26a-2*" "hsa-miR-146b"   "hsa-miR-7(3)"  </span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; [5] "hsa-miR-138(2)" "hsa-miR-138-1*"</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(voom.benchmark<span class="op">$</span>p.val)</span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt;                      Pvalue    log2.FC</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt; hsa-miR-99a*   2.020888e-05 -1.7646475</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt; hsa-miR-26a-2* 4.215158e-05 -0.9432175</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; hsa-miR-146b   7.168172e-05  1.5007801</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; hsa-miR-7(3)   7.320699e-05  1.2112745</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; hsa-miR-138(2) 8.713003e-05  3.1486759</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">#&gt; hsa-miR-138-1* 1.607036e-04  2.2794681</span></span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(voom.test.RUVr<span class="op">$</span>id.list)</span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt; [1] "hsa-miR-125b(2)" "hsa-miR-99b"     "hsa-miR-99a*"    "hsa-miR-99a"    </span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">#&gt; [5] "hsa-miR-125a"    "hsa-miR-146b"</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(voom.test.RUVr<span class="op">$</span>p.val)</span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">#&gt;                       Pvalue   log2.FC</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co">#&gt; hsa-miR-125b(2) 1.138177e-07 -1.842135</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="co">#&gt; hsa-miR-99b     1.177162e-07 -1.553447</span></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="co">#&gt; hsa-miR-99a*    3.501843e-07 -2.142053</span></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="co">#&gt; hsa-miR-99a     6.603158e-07 -1.904275</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="co">#&gt; hsa-miR-125a    2.243507e-06 -1.374217</span></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="co">#&gt; hsa-miR-146b    3.071453e-06  1.909280</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#functions-for-depth-normalization">Functions for Depth Normalization</a></li>
      <li><a href="#functions-for-differential-expression-analysis">Functions for Differential Expression Analysis</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Li-Xuan Qin, Jian Zou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
