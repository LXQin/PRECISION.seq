<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to DepthNorm Functions â€¢ precision.seq</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to DepthNorm Functions">
<meta property="og:description" content="precision.seq">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">precision.seq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Analysis_Pipeline.html">Pipeline of the Paper</a>
    </li>
    <li>
      <a href="../articles/Intro_Data.html">Introduction to DepthNorm Data</a>
    </li>
    <li>
      <a href="../articles/Intro_Functions.html">Introduction to DepthNorm Functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Intro_Functions_files/header-attrs-2.3/header-attrs.js"></script><script src="Intro_Functions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to DepthNorm Functions</h1>
            
      
      
      <div class="hidden name"><code>Intro_Functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="kw">list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">precision.seq</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">DESeq</span>)</pre></body></html></div>
<p>One critical aspect of RNA sequencing data normalization is the sequencing depth. We prepared nine commonly used depth normalization methods and a pair of well-designed datasets used for statistical evaluations in this package.</p>
<div id="functions-for-depth-normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-depth-normalization" class="anchor"></a>Functions for Depth Normalization</h2>
<p>In this section, we will present how to use the normalization functions in this package. The raw count data in the format of data frame or matrix (with columns for samples and rows for markers/genes) and the vector of characters indicating the group of each sample are needed as input. The output depends on the normalization methods. If the normalization methods are re-scalling based, normalized dataset and scalling factor will be provided as output; if the normalization methods are regression based, normalized dataset, which only used for exploration and the adjusting factor will be provided as output.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">test.TC</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.TC.html">norm.TC</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>)
<span class="no">test.UQ</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.UQ.html">norm.UQ</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>)
<span class="no">test.med</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.med.html">norm.med</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>)
<span class="no">test.TMM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.TMM.html">norm.TMM</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>)
<span class="no">test.DESeq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.DESeq.html">norm.DESeq</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>)
<span class="no">test.PoissonSeq</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.PoissonSeq.html">norm.PoissonSeq</a></span>(<span class="no">data.test</span>)
<span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span>
<span class="no">test.QN</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.QN.html">norm.QN</a></span>(<span class="no">data.test</span>)
<span class="no">test.SVA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.SVA.html">norm.SVA</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>)
<span class="co">#&gt; Number of significant surrogate variables is:  1 </span>
<span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span>
<span class="no">test.RUVg</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"RUVg"</span>)
<span class="no">test.RUVs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"RUVs"</span>)
<span class="no">test.RUVr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"RUVr"</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">test.TMM</span>$<span class="no">scaling.factor</span>)
<span class="co">#&gt; [1] 1.1988963 0.4295173 1.2377190 1.3487078 1.1959610 1.8503994</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">test.TMM</span>$<span class="no">dat.normed</span>[,<span class="fl">1</span>:<span class="fl">5</span>])
<span class="co">#&gt;                    MXF2516      MXF742      MXF772       MXF832       MXF836</span>
<span class="co">#&gt; hsa-let-7a-2*      0.00000     0.00000     0.00000     1.482901     1.672295</span>
<span class="co">#&gt; hsa-let-7a(3)  70709.20148 14821.28856 48696.83516 53595.004767 39640.925166</span>
<span class="co">#&gt; hsa-let-7a*(2)  2829.26889    34.92292   126.84623   269.146516   102.846164</span>
<span class="co">#&gt; hsa-let-7b      7376.78480 10437.29762 20702.59825 20564.869850 14440.270362</span>
<span class="co">#&gt; hsa-let-7b*       24.18891    32.59473    58.97946    83.042451    71.072552</span>
<span class="co">#&gt; hsa-let-7c     23107.92019  1008.10838 13457.01204  5153.822120 11593.187526</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">test.SVA</span>$<span class="no">adjust.factor</span>)
<span class="co">#&gt;             [,1]</span>
<span class="co">#&gt; [1,]  0.28535304</span>
<span class="co">#&gt; [2,]  0.03121055</span>
<span class="co">#&gt; [3,] -0.07462108</span>
<span class="co">#&gt; [4,] -0.06139403</span>
<span class="co">#&gt; [5,] -0.07546172</span>
<span class="co">#&gt; [6,] -0.12748833</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">test.SVA</span>$<span class="no">dat.normed</span>[,<span class="fl">1</span>:<span class="fl">5</span>])
<span class="co">#&gt;                     MXF2516       MXF742        MXF772       MXF832</span>
<span class="co">#&gt; hsa-let-7a-2*  3.126439e+00    0.3419549    -0.8175775     1.327343</span>
<span class="co">#&gt; hsa-let-7a(3)  1.143937e+05 9605.7728904 52527.0508087 65911.068255</span>
<span class="co">#&gt; hsa-let-7a*(2) 3.041342e+03  -23.3533362   248.6987096   438.444546</span>
<span class="co">#&gt; hsa-let-7b     2.310206e+04 6042.4781503 21895.4551525 24668.362809</span>
<span class="co">#&gt; hsa-let-7b*    6.650161e+01   18.1017473    63.1931625   103.931485</span>
<span class="co">#&gt; hsa-let-7c     3.792122e+04 1550.5108226 13984.1515878  4752.753259</span>
<span class="co">#&gt;                      MXF836</span>
<span class="co">#&gt; hsa-let-7a-2*      1.173212</span>
<span class="co">#&gt; hsa-let-7a(3)  39575.789137</span>
<span class="co">#&gt; hsa-let-7a*(2)   215.731738</span>
<span class="co">#&gt; hsa-let-7b     13499.451384</span>
<span class="co">#&gt; hsa-let-7b*       75.082684</span>
<span class="co">#&gt; hsa-let-7c     11163.051990</span></pre></body></html></div>
</div>
<div id="functions-for-differential-expression-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-differential-expression-analysis" class="anchor"></a>Functions for Differential Expression Analysis</h2>
<p>We pack two DEA functions, edgeR and voom-limma, in this package. The input could be either the normalized dataset (always from re-scalling methods) or the non-normalized dataset with adjusting factor (always from regression-based methods). Names of DE markers/genes (p = 0.01 as cut-off point by default), p-values for each marker/gene, and log2 fold change are provided in output.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">edgeR.benchmark</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="no">data.benchmark</span>, <span class="no">data.group</span>)
<span class="no">voom.benchmark</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="no">data.benchmark</span>, <span class="no">data.group</span>)

<span class="no">edgeR.test.TMM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="no">test.TMM</span>$<span class="no">dat.normed</span>, <span class="no">data.group</span>)
<span class="no">voom.test.TMM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="no">test.TMM</span>$<span class="no">dat.normed</span>, <span class="no">data.group</span>)

<span class="no">edgeR.test.RUVr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>,
                            <span class="kw">normalized</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                            <span class="kw">adjust</span> <span class="kw">=</span> <span class="no">test.RUVr</span>$<span class="no">adjust.factor</span>)
<span class="no">voom.test.RUVr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="no">data.test</span>, <span class="no">data.group</span>,
                          <span class="kw">normalized</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                          <span class="kw">adjust</span> <span class="kw">=</span> <span class="no">test.RUVr</span>$<span class="no">adjust.factor</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">voom.benchmark</span>$<span class="no">id.list</span>)
<span class="co">#&gt; [1] "hsa-miR-99a*"   "hsa-miR-26a-2*" "hsa-miR-146b"   "hsa-miR-7(3)"  </span>
<span class="co">#&gt; [5] "hsa-miR-138(2)" "hsa-miR-138-1*"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">voom.benchmark</span>$<span class="no">p.val</span>)
<span class="co">#&gt;                      Pvalue    log2.FC</span>
<span class="co">#&gt; hsa-miR-99a*   2.020888e-05 -1.7646475</span>
<span class="co">#&gt; hsa-miR-26a-2* 4.215158e-05 -0.9432175</span>
<span class="co">#&gt; hsa-miR-146b   7.168172e-05  1.5007801</span>
<span class="co">#&gt; hsa-miR-7(3)   7.320699e-05  1.2112745</span>
<span class="co">#&gt; hsa-miR-138(2) 8.713003e-05  3.1486759</span>
<span class="co">#&gt; hsa-miR-138-1* 1.607036e-04  2.2794681</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">voom.test.RUVr</span>$<span class="no">id.list</span>)
<span class="co">#&gt; [1] "hsa-miR-125b(2)" "hsa-miR-99b"     "hsa-miR-99a*"    "hsa-miR-99a"    </span>
<span class="co">#&gt; [5] "hsa-miR-125a"    "hsa-miR-146b"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">voom.test.RUVr</span>$<span class="no">p.val</span>)
<span class="co">#&gt;                       Pvalue   log2.FC</span>
<span class="co">#&gt; hsa-miR-125b(2) 1.138177e-07 -1.842135</span>
<span class="co">#&gt; hsa-miR-99b     1.177162e-07 -1.553447</span>
<span class="co">#&gt; hsa-miR-99a*    3.501843e-07 -2.142053</span>
<span class="co">#&gt; hsa-miR-99a     6.603158e-07 -1.904275</span>
<span class="co">#&gt; hsa-miR-125a    2.243507e-06 -1.374217</span>
<span class="co">#&gt; hsa-miR-146b    3.071453e-06  1.909280</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Li-Xuan Qin, Jian Zou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
