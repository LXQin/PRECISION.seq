<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to DepthNorm â€¢ DepthNorm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to DepthNorm">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DepthNorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">Introduction to DepthNorm</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to DepthNorm</h1>
            
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DepthNorm)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DESeq)</span></code></pre></div>
<p>One critical aspect of RNA sequencing data normalization is the sequencing depth. We prepared nine commonly used depth normalization methods and a pair of well-designed datasets used for statistical evaluations in this package.</p>
<div id="functions-for-depth-normalization" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-depth-normalization" class="anchor"></a>Functions for Depth Normalization</h2>
<p>In this section, we will present how to use the normalization functions in this package. The raw count data in the format of data frame or matrix (with columns for samples and rows for markers/genes) and the vector of characters indicating the group of each sample are needed as input. The output depends on the normalization methods. If the normalization methods are re-scalling based, normalized dataset and scalling factor will be provided as output; if the normalization methods are regression based, normalized dataset, which only used for exploration and the adjusting factor will be provided as output.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>emp.group =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'MXF'</span>,<span class="dv">9</span>),<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'PMFH'</span>,<span class="dv">9</span>)),<span class="dv">3</span>))</span>
<span id="cb2-2"><a href="#cb2-2"></a>test.TC =<span class="st"> </span><span class="kw"><a href="../reference/norm.TC.html">norm.TC</a></span>(test, emp.group)</span>
<span id="cb2-3"><a href="#cb2-3"></a>test.UQ =<span class="st"> </span><span class="kw"><a href="../reference/norm.UQ.html">norm.UQ</a></span>(test, emp.group)</span>
<span id="cb2-4"><a href="#cb2-4"></a>test.med =<span class="st"> </span><span class="kw"><a href="../reference/norm.med.html">norm.med</a></span>(test, emp.group)</span>
<span id="cb2-5"><a href="#cb2-5"></a>test.TMM =<span class="st"> </span><span class="kw"><a href="../reference/norm.TMM.html">norm.TMM</a></span>(test, emp.group)</span>
<span id="cb2-6"><a href="#cb2-6"></a>test.DESeq =<span class="st"> </span><span class="kw"><a href="../reference/norm.DESeq.html">norm.DESeq</a></span>(test, emp.group)</span>
<span id="cb2-7"><a href="#cb2-7"></a>test.PoissonSeq =<span class="st"> </span><span class="kw"><a href="../reference/norm.PoissonSeq.html">norm.PoissonSeq</a></span>(test, emp.group)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; 328 genes has been filtered because they contains too small number of reads across the experiments.</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>test.QN =<span class="st"> </span><span class="kw"><a href="../reference/norm.QN.html">norm.QN</a></span>(test, emp.group)</span>
<span id="cb2-10"><a href="#cb2-10"></a>test.SVA =<span class="st"> </span><span class="kw"><a href="../reference/norm.SVA.html">norm.SVA</a></span>(test, emp.group)</span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; Number of significant surrogate variables is:  1 </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; Iteration (out of 5 ):1  2  3  4  5</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>test.RUVg =<span class="st">  </span><span class="kw"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(test, emp.group, <span class="dt">method =</span> <span class="st">"RUVg"</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>test.RUVs =<span class="st">  </span><span class="kw"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(test, emp.group, <span class="dt">method =</span> <span class="st">"RUVs"</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>test.RUVr =<span class="st">  </span><span class="kw"><a href="../reference/norm.RUV.html">norm.RUV</a></span>(test, emp.group, <span class="dt">method =</span> <span class="st">"RUVr"</span>)</span></code></pre></div>
</div>
<div id="functions-for-differential-expression-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-for-differential-expression-analysis" class="anchor"></a>Functions for Differential Expression Analysis</h2>
<p>We pack two DEA functions, edgeR and voom-limma, in this package. The input could be the normalized dataset (always from re-scalling methods) or the non-normalized dataset with adjusting factor (always from regression-based methods). Names of DE markers/genes (p = 0.01 as cut-off point by default), p-values for each marker/gene, and log2 fold change are provided in output. We also embed the normalization methods in the DEA functions, and provide a function from raw dataset to DEA results.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>edgeR.benchmark =<span class="st"> </span><span class="kw"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(benchmark, emp.group)</span>
<span id="cb3-2"><a href="#cb3-2"></a>voom.benchmark =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(benchmark, emp.group)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>edgeR.test.TMM =<span class="st"> </span><span class="kw"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(test.TMM<span class="op">$</span>dat.normed, emp.group)</span>
<span id="cb3-5"><a href="#cb3-5"></a>voom.test.TMM =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(test.TMM<span class="op">$</span>dat.normed, emp.group)</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>edgeR.test.RUVr =<span class="st"> </span><span class="kw"><a href="../reference/DE.edgeR.html">DE.edgeR</a></span>(test, emp.group, <span class="dt">normalized =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>                           <span class="dt">adjust =</span> test.RUVr<span class="op">$</span>adjust.factor)</span>
<span id="cb3-9"><a href="#cb3-9"></a>voom.test.RUVr =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(test, emp.group, <span class="dt">normalized =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>                         <span class="dt">adjust =</span> test.RUVr<span class="op">$</span>adjust.factor)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>pip.test =<span class="st"> </span><span class="kw"><a href="../reference/norm.voom.pip.html">norm.voom.pip</a></span>(test, emp.group, <span class="st">"norm.RUV"</span>, <span class="dt">RUV_method =</span> <span class="st">"RUVr"</span>)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#functions-for-depth-normalization">Functions for Depth Normalization</a></li>
      <li><a href="#functions-for-differential-expression-analysis">Functions for Differential Expression Analysis</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jian Zou, Li-Xuan Qin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
