<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to DepthNorm Data â€¢ DepthNorm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to DepthNorm Data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DepthNorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro_Data.html">Introduction to DepthNorm Data</a>
    </li>
    <li>
      <a href="../articles/Intro_Functions.html">Introduction to DepthNorm Functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to DepthNorm Data</h1>
            
      
      
      <div class="hidden name"><code>Intro_Data.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DepthNorm)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(DESeq)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(limma)</span></code></pre></div>
<p>The unique pair of miRNA sequencing data is collected from two of the most common and aggressive soft tissue sarcoma subtypes: myxofibrosarcoma (MXF) and pleomorphic malignant fibrous histiocytoma (PMFH). Collected at MSK between 2002 and 2012, 27 MXF samples and 27 PMFH samples including 1033 miRNA markers are extracted from newly diagnosed untreated tumors with sufficient quality and quantity. These samples are then measured twice separately. One of the obtained miRNA sequencing data (named as <code>benchmark</code> data in this package) is prepared by uniform handling and balanced sample-to-library-assignment minimizing artifact effects, which needs no normalization in the downstream analysis, while the other one (named as <code>test</code> data in this package) is collected in the usual way, which requires normalization for removing obscuring variability.</p>
<div id="benchmark-data-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#benchmark-data-analysis" class="anchor"></a>Benchmark Data Analysis</h2>
<div id="overall-data-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#overall-data-distribution" class="anchor"></a>Overall Data Distribution</h3>
<p>We show the boxplot of the log2(benchmark+1) for each sample.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>benchmark.log =<span class="st"> </span>benchmark.log =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(benchmark <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(benchmark.log, </span>
<span id="cb2-3"><a href="#cb2-3"></a>        <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(benchmark.log)),</span>
<span id="cb2-4"><a href="#cb2-4"></a>                     <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">2</span>]),</span>
<span id="cb2-5"><a href="#cb2-5"></a>        <span class="dt">ylab =</span> <span class="st">"Log2 Count"</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">20</span>),</span>
<span id="cb2-6"><a href="#cb2-6"></a>        <span class="dt">xaxt =</span> <span class="st">"n"</span>, <span class="dt">outline =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topright"</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb2-8"><a href="#cb2-8"></a>       <span class="dt">pch =</span> <span class="st">"x"</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div id="differential-expression-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#differential-expression-analysis" class="anchor"></a>Differential Expression Analysis</h3>
<p>We continue to perform the DEA on benchmark data using voom-limma, and present the relationship between p-values and log fold change in volcano plot.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>emp.group =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'MXF'</span>,<span class="dv">9</span>),<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">'PMFH'</span>,<span class="dv">9</span>)),<span class="dv">3</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a>benchmark.voom =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="dt">RC =</span> benchmark, <span class="dt">groups =</span> emp.group, <span class="dt">P =</span> <span class="fl">0.01</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>DE.bench =<span class="st"> </span>benchmark.voom<span class="op">$</span>id.list</span>
<span id="cb3-4"><a href="#cb3-4"></a>benchmark.voom.dat =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">dm =</span> benchmark.voom<span class="op">$</span>p.val[,<span class="dv">2</span>],</span>
<span id="cb3-5"><a href="#cb3-5"></a>                            <span class="dt">p.value =</span> benchmark.voom<span class="op">$</span>p.val[,<span class="dv">1</span>])</span>
<span id="cb3-6"><a href="#cb3-6"></a>mask &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(benchmark.voom.dat, p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">.01</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>cols &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(mask,<span class="st">"red"</span>, <span class="st">"black"</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(benchmark.voom.dat, <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(dm, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(p.value), <span class="dt">cex =</span> <span class="fl">.5</span>, <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>                          <span class="dt">col =</span> cols, <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">3.6</span>, <span class="fl">3.6</span>),</span>
<span id="cb3-10"><a href="#cb3-10"></a>                          <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb3-11"><a href="#cb3-11"></a>                          <span class="dt">xlab =</span> <span class="st">"Mean Difference: PMFH - MXF"</span>))</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">h =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="scatterplot-of-group-mean-averages-v-s--group-mean-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#scatterplot-of-group-mean-averages-v-s--group-mean-differences" class="anchor"></a>Scatterplot of Group Mean Averages V.S. Group Mean Differences</h3>
<p>In the below scatterplot in log scale, red dots indicates the DE markers with p &lt; 0.01 as cut-off point.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>cols =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(benchmark.log) <span class="op">%in%</span><span class="st"> </span>DE.bench, <span class="st">"red"</span>, <span class="st">"black"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(benchmark.log),</span>
<span id="cb4-3"><a href="#cb4-3"></a>     <span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(benchmark.log[,<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(benchmark.log))], <span class="dv">1</span>, mean) <span class="op">-</span><span class="st"> </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">       </span><span class="kw"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(benchmark.log[,<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(benchmark.log))], <span class="dv">1</span>, mean),</span>
<span id="cb4-5"><a href="#cb4-5"></a>     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">col =</span> cols,</span>
<span id="cb4-6"><a href="#cb4-6"></a>     <span class="dt">xlab =</span> <span class="st">"Group Mean Average of Log2 Count"</span>, </span>
<span id="cb4-7"><a href="#cb4-7"></a>     <span class="dt">ylab =</span> <span class="st">"Group Mean Difference of Log2 Count"</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>     <span class="dt">main =</span> <span class="st">""</span>)</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div id="test-data-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#test-data-analysis" class="anchor"></a>Test Data Analysis</h2>
<div id="overall-data-distribution-1" class="section level3">
<h3 class="hasAnchor">
<a href="#overall-data-distribution-1" class="anchor"></a>Overall Data Distribution</h3>
<p>We show the boxplot of the log2(test+1) for each sample.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>test.log =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(test <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(test.log, </span>
<span id="cb5-3"><a href="#cb5-3"></a>        <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(benchmark.log)),</span>
<span id="cb5-4"><a href="#cb5-4"></a>                     <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">2</span>]),</span>
<span id="cb5-5"><a href="#cb5-5"></a>        <span class="dt">xaxt =</span> <span class="st">"n"</span>, <span class="dt">outline =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="st">"topleft"</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MXF"</span>, <span class="st">"PMFH"</span>), <span class="dt">bty =</span> <span class="st">"n"</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>       <span class="dt">pch =</span> <span class="st">"x"</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">2</span>)[<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="differential-expression-analysis-1" class="section level3">
<h3 class="hasAnchor">
<a href="#differential-expression-analysis-1" class="anchor"></a>Differential Expression Analysis</h3>
<p>We continue to perform the DEA on test data using voom-limma without any normalization, and present the relationship between p-values and log fold change in volcano plot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>test.voom =<span class="st"> </span><span class="kw"><a href="../reference/DE.voom.html">DE.voom</a></span>(<span class="dt">RC =</span> test, <span class="dt">groups =</span> emp.group, <span class="dt">P =</span> <span class="fl">0.01</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>test.voom.dat =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">dm =</span> test.voom<span class="op">$</span>p.val[,<span class="dv">2</span>],</span>
<span id="cb6-3"><a href="#cb6-3"></a>                            <span class="dt">p.value =</span> test.voom<span class="op">$</span>p.val[,<span class="dv">1</span>])</span>
<span id="cb6-4"><a href="#cb6-4"></a>mask =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(test.voom.dat, p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">.01</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>cols =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(mask,<span class="st">"red"</span>, <span class="st">"black"</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw"><a href="https://rdrr.io/r/base/with.html">with</a></span>(test.voom.dat, <span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(dm, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log10</a></span>(p.value), <span class="dt">cex =</span> <span class="fl">.5</span>, <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>                         <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">6</span>), <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">3.6</span>, <span class="fl">3.6</span>),</span>
<span id="cb6-8"><a href="#cb6-8"></a>                         <span class="dt">col =</span> cols, <span class="dt">xlab =</span> <span class="st">"Mean Difference: PMFH - MXF"</span>))</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">h =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="venn-diagram-between-benchmark-and-test" class="section level3">
<h3 class="hasAnchor">
<a href="#venn-diagram-between-benchmark-and-test" class="anchor"></a>Venn Diagram Between Benchmark and Test</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>pval.bench.test =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/limma/man/cbind.html">cbind</a></span>(<span class="dt">bench.pval =</span> benchmark.voom<span class="op">$</span>p.val[,<span class="dv">1</span>], </span>
<span id="cb7-2"><a href="#cb7-2"></a>                        <span class="dt">test.pval =</span> test.voom<span class="op">$</span>p.val[<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(benchmark.voom<span class="op">$</span>p.val),<span class="dv">1</span>]))</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span>(pval.bench.test)</span>
<span id="cb7-4"><a href="#cb7-4"></a>bench.sig &lt;-<span class="st"> </span>(bench.pval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>test.sig &lt;-<span class="st"> </span>(test.pval <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>venn2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/limma/man/cbind.html">cbind</a></span>(bench.sig, test.sig)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw"><a href="https://rdrr.io/pkg/limma/man/venn.html">vennDiagram</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/limma/man/venn.html">vennCounts</a></span>(venn2), </span>
<span id="cb7-8"><a href="#cb7-8"></a>            <span class="dt">names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Benchmark"</span>, <span class="st">"Test"</span>), </span>
<span id="cb7-9"><a href="#cb7-9"></a>            <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">counts.col =</span> <span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="group-means-of-mxf" class="section level3">
<h3 class="hasAnchor">
<a href="#group-means-of-mxf" class="anchor"></a>Group Means of MXF</h3>
<p>Scatterplot for the relationship between group means of benchmark and test data for MXF.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>benchmark.log.MXF.mean =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(benchmark.log[, <span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(benchmark.log))])</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(benchmark.log.MXF.mean,</span>
<span id="cb8-3"><a href="#cb8-3"></a>     <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(test.log[,<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"MXF"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(test.log))]), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>     <span class="dt">xlab =</span> <span class="st">"Group Mean Average of Log2 Count in Benchmark"</span>, </span>
<span id="cb8-5"><a href="#cb8-5"></a>     <span class="dt">ylab =</span> <span class="st">"Group Mean Average of Log2 Count in Test"</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>     <span class="dt">main =</span> <span class="st">"MXF"</span>, <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="group-means-of-pmfh" class="section level3">
<h3 class="hasAnchor">
<a href="#group-means-of-pmfh" class="anchor"></a>Group Means of PMFH</h3>
<p>Scatterplot for the relationship between group means of benchmark and test data for PMFH.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>benchmark.log.PMFH.mean =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(benchmark.log[, <span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(benchmark.log))])</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(benchmark.log.PMFH.mean,</span>
<span id="cb9-3"><a href="#cb9-3"></a>     <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(test.log[,<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"PMFH"</span>, <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(test.log))]), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>     <span class="dt">xlab =</span> <span class="st">"Group Mean Average of Log2 Count in Benchmark"</span>, </span>
<span id="cb9-5"><a href="#cb9-5"></a>     <span class="dt">ylab =</span> <span class="st">"Group Mean AVerage of Log2 Count in Test"</span>,</span>
<span id="cb9-6"><a href="#cb9-6"></a>     <span class="dt">main =</span> <span class="st">"PMFH"</span>, <span class="dt">xlim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="Intro_Data_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div id="simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation" class="anchor"></a>Simulation</h2>
<p>In this section, we will present how to use <code><a href="../reference/simu.html">simu()</a></code> function to generate desired simulated dataset. We will simulate all the possible datasets with proportion of DE between 0.0175 and 0.0225 and median of mean differences between -0.5 and 0.5.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>simulated =<span class="st"> </span><span class="kw"><a href="../reference/simu.html">simu</a></span>(<span class="dt">proportion_L =</span> <span class="fl">0.0175</span>, <span class="dt">proportion_R =</span> <span class="fl">0.0225</span>, <span class="dt">median_L =</span> <span class="fl">-0.5</span>, <span class="dt">median_R =</span> <span class="fl">0.5</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(simulated<span class="op">$</span>simulated_benchmark[[<span class="dv">1</span>]])[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;                  D20   D17    D9   E17     E5</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; hsa-let-7a-2*      6     4     2    21     11</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; hsa-let-7a(3)  76141 61589 57395 90362 268842</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; hsa-let-7a*(2)   811   436   142   938   1517</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; hsa-let-7b     48305 29023 14939 30967  77765</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; hsa-let-7b*      392   125    74   170    607</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; hsa-let-7c     10827  9774 12911 16358  65477</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(simulated<span class="op">$</span>simulated_test[[<span class="dv">1</span>]])[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt;                  D20   D17     D9   E17     E5</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; hsa-let-7a-2*      2     1      0     6      2</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; hsa-let-7a(3)  72284 53958 127231 30311 253696</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; hsa-let-7a*(2)   363   113    240   163   1162</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; hsa-let-7b     27736 15832  25940  7626  93419</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">#&gt; hsa-let-7b*      112    32     59    50    258</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">#&gt; hsa-let-7c      6951  8156  28152  4349  71733</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#benchmark-data-analysis">Benchmark Data Analysis</a></li>
      <li><a href="#test-data-analysis">Test Data Analysis</a></li>
      <li><a href="#simulation">Simulation</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Li-Xuan Qin, Jian Zou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
